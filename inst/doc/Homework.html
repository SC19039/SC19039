<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="19039" />

<meta name="date" content="2020-01-01" />

<title>Homework</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">19039</h4>
<h4 class="date">2020-01-01</h4>



<div id="the-homework-1" class="section level1">
<h1>The homework 1</h1>
<div id="questions" class="section level2">
<h2>Questions</h2>
<p>Give three simple examples including text,figures,and tables by using knitr.</p>
</div>
<div id="texts" class="section level2">
<h2>Texts</h2>
<p>Some simple codes are written as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">x1&lt;-<span class="kw">c</span>(<span class="fl">1.2</span>,<span class="fl">2.6</span>, <span class="fl">3.3</span>,<span class="fl">4.5</span>,<span class="fl">6.1</span>,<span class="fl">6.9</span>,<span class="fl">7.5</span>,<span class="fl">8.4</span>,<span class="fl">9.8</span>,<span class="fl">10.1</span>,<span class="fl">11.2</span>,<span class="fl">12.8</span>,<span class="fl">13.5</span>,<span class="fl">14.4</span>,<span class="fl">15.4</span>,<span class="fl">16.7</span>)</a>
<a class="sourceLine" id="cb1-2" title="2">x2&lt;-<span class="kw">c</span>(<span class="fl">0.98</span>,<span class="fl">0.87</span>,<span class="fl">0.85</span>,<span class="fl">0.80</span>,<span class="fl">0.74</span>,<span class="fl">0.69</span>,<span class="fl">0.65</span>,<span class="fl">0.60</span>,<span class="fl">0.52</span>,<span class="fl">0.49</span>,<span class="fl">0.44</span>,<span class="fl">0.39</span>,<span class="fl">0.28</span>,<span class="fl">0.19</span>,<span class="fl">0.15</span>,<span class="fl">0.08</span>)</a>
<a class="sourceLine" id="cb1-3" title="3">x3&lt;-<span class="kw">c</span>(<span class="fl">12.6</span>,<span class="fl">13.1</span>,<span class="dv">14</span>,<span class="fl">15.1</span>,<span class="fl">16.8</span>,<span class="fl">17.2</span>,<span class="fl">18.3</span>,<span class="fl">19.1</span>,<span class="fl">20.1</span>,<span class="fl">21.2</span>,<span class="fl">22.3</span>,<span class="fl">23.5</span>,<span class="fl">24.6</span>,<span class="fl">25.4</span>,<span class="fl">26.7</span>,<span class="fl">27.8</span>)</a>
<a class="sourceLine" id="cb1-4" title="4">y&lt;-<span class="kw">c</span>(<span class="dv">53</span>,<span class="dv">56</span>,<span class="dv">57</span>,<span class="fl">58.9</span>,<span class="fl">59.9</span>,<span class="fl">60.4</span>,<span class="fl">61.9</span>,<span class="fl">62.8</span>,<span class="fl">63.9</span>, <span class="dv">65</span>, <span class="fl">66.4</span>,<span class="fl">68.2</span>,<span class="fl">69.9</span>,<span class="fl">70.8</span>,<span class="fl">72.2</span>,<span class="dv">74</span>)</a>
<a class="sourceLine" id="cb1-5" title="5">fun1&lt;-<span class="kw">lm</span>(y<span class="op">~</span><span class="kw">I</span>(x1<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span>x1<span class="op">+</span>x2<span class="op">+</span>x3)</a>
<a class="sourceLine" id="cb1-6" title="6">fun1</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ I(x1^2) + x1 + x2 + x3)
## 
## Coefficients:
## (Intercept)      I(x1^2)           x1           x2           x3  
##   64.874799    -0.002834     0.803319   -11.113530    -0.101092</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">summary</span>(fun1)<span class="op">$</span>coef </a></code></pre></div>
<pre><code>##                  Estimate  Std. Error    t value     Pr(&gt;|t|)
## (Intercept)  64.874798657 7.921901086  8.1892967 5.226238e-06
## I(x1^2)      -0.002834001 0.009315406 -0.3042274 7.666326e-01
## x1            0.803318777 0.495033489  1.6227564 1.329264e-01
## x2          -11.113530242 5.921585642 -1.8767828 8.730953e-02
## x3           -0.101092012 0.476458879 -0.2121736 8.358519e-01</code></pre>
</div>
<div id="table" class="section level2">
<h2>table</h2>
<p>Letâ€™s take a look at the data about the island by using a table.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(islands))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Africa</td>
<td align="right">11506</td>
</tr>
<tr class="even">
<td>Antarctica</td>
<td align="right">5500</td>
</tr>
<tr class="odd">
<td>Asia</td>
<td align="right">16988</td>
</tr>
<tr class="even">
<td>Australia</td>
<td align="right">2968</td>
</tr>
<tr class="odd">
<td>Axel Heiberg</td>
<td align="right">16</td>
</tr>
<tr class="even">
<td>Baffin</td>
<td align="right">184</td>
</tr>
</tbody>
</table>
<p>The head function means that only the first six data are taken. Let us see data about rock:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(rock))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">area</th>
<th align="right">peri</th>
<th align="right">shape</th>
<th align="right">perm</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4990</td>
<td align="right">2791.90</td>
<td align="right">0.0903296</td>
<td align="right">6.3</td>
</tr>
<tr class="even">
<td align="right">7002</td>
<td align="right">3892.60</td>
<td align="right">0.1486220</td>
<td align="right">6.3</td>
</tr>
<tr class="odd">
<td align="right">7558</td>
<td align="right">3930.66</td>
<td align="right">0.1833120</td>
<td align="right">6.3</td>
</tr>
<tr class="even">
<td align="right">7352</td>
<td align="right">3869.32</td>
<td align="right">0.1170630</td>
<td align="right">6.3</td>
</tr>
<tr class="odd">
<td align="right">7943</td>
<td align="right">3948.54</td>
<td align="right">0.1224170</td>
<td align="right">17.1</td>
</tr>
<tr class="even">
<td align="right">7979</td>
<td align="right">4010.15</td>
<td align="right">0.1670450</td>
<td align="right">17.1</td>
</tr>
</tbody>
</table>
</div>
<div id="figure" class="section level2">
<h2>Figure</h2>
<p>First ,the graph of fun1 is shown as follows:</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The <code>echo = FALSE</code> parameter are aimed at preventing printing of the R code . Another example:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">x4=<span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dt">mean=</span><span class="fl">1.5</span>,<span class="dt">sd=</span><span class="dv">2</span>),<span class="dt">ncol=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw">plot</span>(x4)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We get a set of data with a mean of 1.5 and a variance of 2.</p>
</div>
</div>
<div id="the-homework-2" class="section level1">
<h1>The homework 2</h1>
<div id="questions-1" class="section level2">
<h2>1 Questions</h2>
<p>Learn to use r to generate random numbers.Here we solve three questions about Rayleigh distribution, normal location mixture,Wishart distribution .</p>
</div>
<div id="rayleigh-distribution.-exercises-3.4" class="section level2">
<h2>2 Rayleigh distribution.( Exercises 3.4)</h2>
<p>First,we clear variable by using rm(list = ls()).Then we write a function to get a nxd matrix.We get D-dimensional independent random variables.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co">#Clear variable</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co"># Write a function to generate n random vectors from MVN(mu, Sigma)</span></a>
<a class="sourceLine" id="cb8-4" title="4">wf1 &lt;-<span class="st"> </span><span class="cf">function</span>(n, mu, Sigma) {</a>
<a class="sourceLine" id="cb8-5" title="5"> <span class="co"># dimension is inferred from mu and Sigma </span></a>
<a class="sourceLine" id="cb8-6" title="6">  di &lt;-<span class="st"> </span><span class="kw">length</span>(mu)</a>
<a class="sourceLine" id="cb8-7" title="7">  <span class="co">#Eigenvalue decomposition for sigma</span></a>
<a class="sourceLine" id="cb8-8" title="8">  eva &lt;-<span class="st"> </span><span class="kw">eigen</span>(Sigma, <span class="dt">symmetric =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb8-9" title="9">  <span class="co">#Get the value of the eigenvalue</span></a>
<a class="sourceLine" id="cb8-10" title="10">  lam &lt;-<span class="st"> </span>eva<span class="op">$</span>values</a>
<a class="sourceLine" id="cb8-11" title="11">  <span class="co">#Get the vector of the eigenvalue</span></a>
<a class="sourceLine" id="cb8-12" title="12">  Ve &lt;-<span class="st"> </span>eva<span class="op">$</span>vectors</a>
<a class="sourceLine" id="cb8-13" title="13">  <span class="co">#Here we use sqrt(lambda) to make sure Z</span></a>
<a class="sourceLine" id="cb8-14" title="14">  C &lt;-<span class="st"> </span>Ve <span class="op">%*%</span><span class="st"> </span><span class="kw">diag</span>(<span class="kw">sqrt</span>(lam)) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(Ve)</a>
<a class="sourceLine" id="cb8-15" title="15">  Y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n<span class="op">*</span>di), <span class="dt">nrow =</span> n, <span class="dt">ncol =</span> di)</a>
<a class="sourceLine" id="cb8-16" title="16">  <span class="co">#X is the matrix we need</span></a>
<a class="sourceLine" id="cb8-17" title="17">  X &lt;-<span class="st"> </span>Y <span class="op">%*%</span><span class="st"> </span>C <span class="op">+</span><span class="st"> </span><span class="kw">matrix</span>(mu, n, di, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb8-18" title="18">}</a></code></pre></div>
<p>In order to call this function, we write a loop as follows. In the loop, we take the variance equal to 1,3,8,15.We draw a histogram and compare it with the density function curve.The density function formula is <span class="math display">\[f(x)=\frac{x}{\sigma^{2}} e^{-x^{2} /\left(2 \sigma^{2}\right)}\]</span></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="co">#Initial value</span></a>
<a class="sourceLine" id="cb9-2" title="2">mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb9-3" title="3"><span class="co">#Preparing to draw four graphs</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb9-5" title="5"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb9-6" title="6"><span class="co"># To get four graphs,we need a for loop.</span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">8</span>,<span class="dv">15</span>)){</a>
<a class="sourceLine" id="cb9-8" title="8">  Sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(i, <span class="dv">0</span>, <span class="dv">0</span>, i), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb9-9" title="9">  X3 &lt;-<span class="st"> </span><span class="kw">wf1</span>(<span class="dv">1000</span>, mu, Sigma)</a>
<a class="sourceLine" id="cb9-10" title="10">  <span class="kw">cov</span>(X3);<span class="co">#Covariance</span></a>
<a class="sourceLine" id="cb9-11" title="11">  a3&lt;-X3<span class="op">^</span><span class="dv">2</span>;</a>
<a class="sourceLine" id="cb9-12" title="12">  <span class="co">#calculate value</span></a>
<a class="sourceLine" id="cb9-13" title="13">  a&lt;-<span class="kw">sqrt</span>(a3[,<span class="dv">1</span>] <span class="op">+</span>a3[,<span class="dv">2</span>]);</a>
<a class="sourceLine" id="cb9-14" title="14">  <span class="co">#Set the abscissa</span></a>
<a class="sourceLine" id="cb9-15" title="15">  break3=<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>,<span class="fl">0.3</span>);</a>
<a class="sourceLine" id="cb9-16" title="16">  <span class="co">#Drawing histogram</span></a>
<a class="sourceLine" id="cb9-17" title="17">  x1=break3</a>
<a class="sourceLine" id="cb9-18" title="18">  <span class="kw">hist</span>(a,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">breaks=</span>break3,<span class="dt">main =</span> i,<span class="dt">col =</span> <span class="st">&#39;yellow&#39;</span>);</a>
<a class="sourceLine" id="cb9-19" title="19">  <span class="co">#Density function curve</span></a>
<a class="sourceLine" id="cb9-20" title="20">  <span class="kw">lines</span>(x1,x1<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x1<span class="op">*</span>x1<span class="op">/</span><span class="dv">2</span><span class="op">/</span>i)<span class="op">/</span>(i))</a>
<a class="sourceLine" id="cb9-21" title="21">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="analysis" class="section level2">
<h2>Analysis</h2>
<p>The histogram is close to the density function curve. As the variance increases, the density function curve gradually becomes flat.</p>
</div>
<div id="normal-location-mixture.-exercises-3.11" class="section level2">
<h2>3 normal location mixture.( Exercises 3.11)</h2>
<p>First,we generate a graph with p1=0.75 and 1-p1=0.25</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">n&lt;-<span class="fl">1e4</span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="co">#Generating a normal distribution</span></a>
<a class="sourceLine" id="cb10-3" title="3">y1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb10-4" title="4">y2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb10-5" title="5"><span class="co">#Assign value to p1</span></a>
<a class="sourceLine" id="cb10-6" title="6">r &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.25</span>,<span class="fl">0.75</span>))</a>
<a class="sourceLine" id="cb10-7" title="7">z1 &lt;-<span class="st"> </span>r<span class="op">*</span>y1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>r)<span class="op">*</span>y2</a>
<a class="sourceLine" id="cb10-8" title="8">x2=<span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">10</span>,<span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb10-9" title="9"><span class="co">#Draw a histogram</span></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="kw">hist</span>(z1,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">15</span>,<span class="fl">0.2</span>),<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</a>
<a class="sourceLine" id="cb10-11" title="11"><span class="co">#Draw a density function curve</span></a>
<a class="sourceLine" id="cb10-12" title="12"><span class="kw">lines</span>(x2,<span class="fl">0.75</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x2<span class="op">*</span>x2<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">+</span><span class="fl">0.25</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(x2<span class="dv">-3</span>)<span class="op">*</span>(x2<span class="dv">-3</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> From the graph,we can see that there is a elbow in it.In order to make the change more obvious, we wrote a cycle to draw nine pictures. The value of probability p1 is taken from 0.1 to 0.5.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co">#A function of drawing picture with p1</span></a>
<a class="sourceLine" id="cb11-2" title="2">wf2&lt;-<span class="cf">function</span>(n,p1){</a>
<a class="sourceLine" id="cb11-3" title="3">y1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb11-4" title="4">y2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb11-5" title="5"><span class="co">#Assign value to p1</span></a>
<a class="sourceLine" id="cb11-6" title="6">r &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="dt">prob =</span> <span class="kw">c</span>(p1,<span class="dv">1</span><span class="op">-</span>p1))</a>
<a class="sourceLine" id="cb11-7" title="7">z &lt;-<span class="st"> </span>r<span class="op">*</span>y1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>r)<span class="op">*</span>y2}</a>
<a class="sourceLine" id="cb11-8" title="8"><span class="co">#Prepare to draw nine pictures</span></a>
<a class="sourceLine" id="cb11-9" title="9"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb11-10" title="10"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb11-11" title="11"><span class="co">#A loop to draw picture</span></a>
<a class="sourceLine" id="cb11-12" title="12"><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">10</span>,<span class="dv">1</span>)){</a>
<a class="sourceLine" id="cb11-13" title="13">p2=i<span class="op">/</span><span class="dv">20</span></a>
<a class="sourceLine" id="cb11-14" title="14">z&lt;-<span class="kw">wf2</span>(<span class="dv">10000</span>,p2)</a>
<a class="sourceLine" id="cb11-15" title="15">x3=<span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">10</span>,<span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb11-16" title="16"><span class="co">#Draw a histogram</span></a>
<a class="sourceLine" id="cb11-17" title="17"><span class="kw">hist</span>(z,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">10</span>,<span class="fl">0.3</span>),<span class="dt">main =</span> p2,<span class="dt">col=</span><span class="st">&#39;blue&#39;</span>) </a>
<a class="sourceLine" id="cb11-18" title="18"><span class="co">#Density function curve</span></a>
<a class="sourceLine" id="cb11-19" title="19"><span class="kw">lines</span>(x3,(<span class="dv">1</span><span class="op">-</span>p2)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x3<span class="op">*</span>x3<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">+</span>p2<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(x3<span class="dv">-3</span>)<span class="op">*</span>(x3<span class="dv">-3</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi))}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="analysis-1" class="section level2">
<h2>Analysis</h2>
<p>From the graph,we know that the graph begin to produce bimodal mixtures as p1=0.25.When p1=0.5,There are two equal doublets.</p>
</div>
<div id="wishart-distribution.-exercises-3.18" class="section level2">
<h2>4 Wishart distribution.( Exercises 3.18)</h2>
<p>We write a function to produce a random sample from a Wishart distribution.The function wish has two paraments:n and sigma.We can get a sample after we input n and sigma.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">wish&lt;-<span class="cf">function</span>(n,sigma1){</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="co">#Cholesky algorithm</span></a>
<a class="sourceLine" id="cb12-3" title="3">chol1&lt;-<span class="kw">chol</span>(sigma1)</a>
<a class="sourceLine" id="cb12-4" title="4"><span class="co">#Get dimension of chol1</span></a>
<a class="sourceLine" id="cb12-5" title="5">dim1=<span class="kw">dim</span>(chol1)</a>
<a class="sourceLine" id="cb12-6" title="6">A=<span class="kw">matrix</span>(<span class="dt">nrow=</span>dim1[<span class="dv">1</span>],<span class="dt">ncol=</span>dim1[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb12-7" title="7"><span class="co"># produce matrix A</span></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>dim1[<span class="dv">1</span>]){</a>
<a class="sourceLine" id="cb12-9" title="9">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>dim1[<span class="dv">2</span>]){</a>
<a class="sourceLine" id="cb12-10" title="10">    <span class="cf">if</span> (i<span class="op">&lt;</span>j){A[i,j]=<span class="dv">0</span>}</a>
<a class="sourceLine" id="cb12-11" title="11">    <span class="cf">else</span> <span class="cf">if</span>(i<span class="op">&gt;</span>j){A[i,j]=<span class="kw">rnorm</span>(<span class="dv">1</span>)}</a>
<a class="sourceLine" id="cb12-12" title="12">    <span class="cf">else</span>{A[i,j]=<span class="kw">sqrt</span>(<span class="kw">rchisq</span>(<span class="dv">1</span>,n<span class="op">-</span>i<span class="op">+</span><span class="dv">1</span>,<span class="dt">ncp=</span><span class="dv">0</span>))}</a>
<a class="sourceLine" id="cb12-13" title="13">  }</a>
<a class="sourceLine" id="cb12-14" title="14">}</a>
<a class="sourceLine" id="cb12-15" title="15">X=<span class="kw">t</span>(chol1)<span class="op">%*%</span>A<span class="op">%*%</span><span class="kw">t</span>(A)<span class="op">%*%</span>chol1}</a></code></pre></div>
<p>We can get a matrix X by <span class="math inline">\(X=LAA^\mathrm{T}L^\mathrm{T}\)</span>,where <span class="math inline">\(AA^\mathrm{T}\)</span>has a <span class="math inline">\(W_{d}(I_{d},n)\)</span> distribution.Let<span class="math inline">\(A=(A_{ij})\)</span> be a lower triangular d Ã— d random matrix with independent entries satisfying: <span class="math display">\[
\begin{array}{l}{\text { 1. } A_{i j} \stackrel{\text { iid }}{\sim} N(0,1), i&gt;j} \\ {\text { 2. } A_{i i} \sim \sqrt{\chi^{2}(n-i+1)}, i=1, \ldots, d}\end{array}
\]</span> Then,<span class="math inline">\(X=LAA^\mathrm{T}L^\mathrm{T}\sim\ W_{d}(\sum,n)\)</span></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">sigma1&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>),<span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb13-2" title="2">n=<span class="dv">10</span></a>
<a class="sourceLine" id="cb13-3" title="3">wi&lt;-<span class="kw">wish</span>(n,sigma1)</a>
<a class="sourceLine" id="cb13-4" title="4">wi</a></code></pre></div>
<pre><code>##          [,1]     [,2]
## [1,] 59.70085 17.89334
## [2,] 17.89334 23.76553</code></pre>
<p>We set n=10 and <span class="math display">\[\sum=\begin{matrix} 
5&amp;1\\
1&amp;5\end{matrix}\]</span> And we get matrix X:</p>
<pre><code>##          [,1]     [,2]
## [1,] 59.70085 17.89334
## [2,] 17.89334 23.76553</code></pre>
</div>
</div>
<div id="the-homework-3" class="section level1">
<h1>The homework 3</h1>
<div id="questions-2" class="section level2">
<h2>1.Questions</h2>
<p>1.Learn to use Monte Carlo method to calculate Integration.</p>
<p>2.Learn to use four methods to reduce variance and select the best one.</p>
</div>
<div id="question-1exercise-5.1" class="section level2">
<h2>2.Question 1(exercise 5.1)</h2>
<p><span class="math inline">\(\textbf{question 1:}\)</span></p>
<p>Compute a Monte Carlo estimate of <span class="math display">\[
\int_{0}^{\pi / 3} \sin (t) d t
\]</span> and compare your estimate with the exact value of the integral.</p>
<p><span class="math inline">\(\textbf{Solution process:}\)</span></p>
<p><span class="math inline">\(\textbf{step1}\)</span>:give the value of m;</p>
<p><span class="math inline">\(\textbf{step2}\)</span>:generate random numbers;</p>
<p><span class="math inline">\(\textbf{step3}\)</span>:take average to approximate the expectatiion;</p>
<p><span class="math inline">\(\textbf{step4}\)</span>:calculate integration by hand.</p>
<p><span class="math inline">\(\textbf{step5}\)</span>:compare two value. Here is the experiment result of n=10000.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">n&lt;-<span class="fl">1e4</span>;</a>
<a class="sourceLine" id="cb16-2" title="2"><span class="co">#generate 10000  random numbers between 0 and pi/3</span></a>
<a class="sourceLine" id="cb16-3" title="3">y&lt;-<span class="kw">runif</span>(n,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span>pi<span class="op">/</span><span class="dv">3</span>);</a>
<a class="sourceLine" id="cb16-4" title="4"><span class="co">#take average</span></a>
<a class="sourceLine" id="cb16-5" title="5">a1&lt;-<span class="kw">mean</span>(<span class="kw">sin</span>(y)<span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span>);</a>
<a class="sourceLine" id="cb16-6" title="6"><span class="kw">print</span>(<span class="kw">c</span>(a1,<span class="fl">0.5</span>))</a></code></pre></div>
<pre><code>## [1] 0.5006386 0.5000000</code></pre>
<p>We draw a graph to see the rusult Let us set n=1000000 and run it again.</p>
<pre><code>## [1] 0.4999249 0.5000000</code></pre>
<p><span class="math inline">\(\textbf{Analysis}\)</span></p>
<p>As the number of experiments increases, the estimated value will be close to the true value.</p>
</div>
<div id="question-2exercise-5.10" class="section level2">
<h2>3.Question 2(exercise 5.10)</h2>
<p><span class="math inline">\(\textbf{question 2:}\)</span> Use Monte Carlo integration with antithetic variables to estimate: <span class="math display">\[\int_{0}^{1}\frac{e^{-x}}{1+x^2}dx,\]</span> and find the approximate reduction in variance as a percentage of the variance without variance reduction.</p>
<p><span class="math inline">\(\textbf{Solution process:}\)</span></p>
<p><span class="math inline">\(\textbf{step1}\)</span>:We write a function to get the estimated value by single Monte Carlo experiment.Every time we get a value.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">yu&lt;-<span class="cf">function</span>(m){</a>
<a class="sourceLine" id="cb19-2" title="2">z&lt;-<span class="kw">runif</span>(m,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max =</span> <span class="dv">1</span>);</a>
<a class="sourceLine" id="cb19-3" title="3">z1&lt;-<span class="kw">exp</span>(<span class="op">-</span>z)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>z<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb19-4" title="4">z2&lt;-<span class="kw">mean</span>(z1)</a>
<a class="sourceLine" id="cb19-5" title="5">z2}</a></code></pre></div>
<p><span class="math inline">\(\textbf{step2}\)</span>:We write second function by using antithetic variable method.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">anti&lt;-<span class="cf">function</span>(m){</a>
<a class="sourceLine" id="cb20-2" title="2">m1&lt;-m<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb20-3" title="3">x&lt;-<span class="kw">runif</span>(m1,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max =</span> <span class="dv">1</span>);</a>
<a class="sourceLine" id="cb20-4" title="4">x1&lt;-<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb20-5" title="5">x2&lt;-<span class="kw">exp</span>(<span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>x))<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>x)<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb20-6" title="6">x3&lt;-<span class="kw">c</span>(x1,x2)</a>
<a class="sourceLine" id="cb20-7" title="7">x4&lt;-<span class="kw">mean</span>(x3)</a>
<a class="sourceLine" id="cb20-8" title="8">}</a></code></pre></div>
<p><span class="math inline">\(\textbf{step3}\)</span>:Finally,we call 1000 times function .After that,we get the value of aa and bb.Both dimension of them are 1000.We can compare variance of them and get a percentage.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">iter=<span class="dv">1000</span></a>
<a class="sourceLine" id="cb21-2" title="2">aa=<span class="kw">numeric</span>(iter)</a>
<a class="sourceLine" id="cb21-3" title="3">bb=<span class="kw">numeric</span>(iter)</a>
<a class="sourceLine" id="cb21-4" title="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>iter) {</a>
<a class="sourceLine" id="cb21-5" title="5">  aa[i]=<span class="kw">yu</span>(<span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb21-6" title="6">  bb[i]=<span class="kw">anti</span>(<span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb21-7" title="7">}</a>
<a class="sourceLine" id="cb21-8" title="8"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">sd</span>(bb),<span class="kw">sd</span>(aa),<span class="kw">sd</span>(bb)<span class="op">/</span><span class="kw">sd</span>(aa)))</a></code></pre></div>
<pre><code>## [1] 0.000480005 0.002398190 0.200152994</code></pre>
<p>To see the result clearly,we draw an image. The first 100 values are taken from aa1 and bb1.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">aa1=aa[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>]</a>
<a class="sourceLine" id="cb23-2" title="2">bb1=bb[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>]</a>
<a class="sourceLine" id="cb23-3" title="3"><span class="kw">plot</span>(aa1,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">xlab=</span><span class="st">&#39;aa1 and bb1&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;&#39;</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>,<span class="dt">main=</span><span class="st">&#39;make a comparision&#39;</span>)</a>
<a class="sourceLine" id="cb23-4" title="4"><span class="kw">lines</span>(bb1,<span class="dt">col=</span><span class="st">&#39;blue&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(\textbf{Analysis}\)</span> The variance ratio of the two methods is about 0.2.We reduce variance successfully even if the effect is not very well. From the above picture ,we can also see that,the later one has a smaller variance.</p>
</div>
<div id="question-3exercise-5.15" class="section level2">
<h2>4.Question 3(exercise 5.15)</h2>
<p><span class="math inline">\(\textbf{question 3:}\)</span></p>
<p>Obtain the stratified importance sampling estimate in Example <span class="math inline">\(5.13\)</span> and compare it with the result of Example <span class="math inline">\(5.10\)</span>.</p>
<p>In Example <span class="math inline">\(5.10\)</span>, we select function <span class="math inline">\(f_{3}(x)=e^{-x}/(1-e^{-1}),0&lt;x&lt;1\)</span> as best result.From that simulation,we get <span class="math inline">\(\hat{\theta}=0.5257801\)</span> and estimated standard error <span class="math inline">\(0.0970314\)</span> by <span class="math inline">\(10000\)</span> replicates. Now we use stratified importance sampling. <span class="math inline">\([0,1]\)</span> is dixided into five subintervals.And on the <span class="math inline">\(j^{th}\)</span> subinterval variables are generated from the density <span class="math display">\[
\frac{5 e^{-x}}{1-e^{-1}}, \quad \frac{j-1}{5}&lt;x&lt;\frac{j}{5}
\]</span> From the conditional density <span class="math inline">\(f_{j}\)</span> of <span class="math inline">\(x\)</span>,we know that <span class="math inline">\(f(x)=\frac{1}{5}f_{j}(x)=\frac{ e^{-x}}{1-e^{-1}}\)</span> Here is the process step: step1:set the value of m2,K,N,sj,T,mat1,ssd. step2:write two functions of <span class="math inline">\(g(x)\)</span> and <span class="math inline">\(f(x)\)</span> Preparing for the loop. step3: start loop :(1)divide the interval (0,1) into five subintervals and calculate the values of <span class="math inline">\(x\)</span> by inverse transform method. (2)calculate <span class="math inline">\(\hat{\theta_{j}}\)</span> by importance sampling. (3)take the averaage of T and ssd. step4:get the value of <span class="math inline">\(\theta\)</span> and its variance</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">m2&lt;-<span class="dv">100000</span>;</a>
<a class="sourceLine" id="cb24-2" title="2">k&lt;-<span class="dv">5</span></a>
<a class="sourceLine" id="cb24-3" title="3">N&lt;-<span class="dv">50</span><span class="co">#number of iteration</span></a>
<a class="sourceLine" id="cb24-4" title="4">sj&lt;-<span class="kw">numeric</span>(m2<span class="op">/</span>k)</a>
<a class="sourceLine" id="cb24-5" title="5">T&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb24-6" title="6">mat1=<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb24-7" title="7">sd=<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb24-8" title="8">ssd=<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb24-9" title="9">g&lt;-<span class="cf">function</span>(x)<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span>(x<span class="op">&lt;</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb24-10" title="10">  <span class="co">#{exp(-x-log(1+x^2))*(x&gt;0)*(x&lt;1)}</span></a>
<a class="sourceLine" id="cb24-11" title="11">f&lt;-<span class="cf">function</span>(x)</a>
<a class="sourceLine" id="cb24-12" title="12">{<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))}</a>
<a class="sourceLine" id="cb24-13" title="13">duan=<span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.6</span>,<span class="fl">0.8</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb24-14" title="14"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb24-15" title="15">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>){</a>
<a class="sourceLine" id="cb24-16" title="16">    sj&lt;-<span class="kw">f</span>(<span class="kw">runif</span>(m2<span class="op">/</span>k,duan[j],duan[j<span class="op">+</span><span class="dv">1</span>]))<span class="co">#generate x</span></a>
<a class="sourceLine" id="cb24-17" title="17">    T[j]&lt;-<span class="kw">mean</span>(<span class="dv">5</span><span class="op">*</span><span class="kw">g</span>(sj)<span class="op">/</span>(<span class="dv">5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>sj)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))))<span class="co">#æ¯æ®µå‡å€¼</span></a>
<a class="sourceLine" id="cb24-18" title="18">    sd&lt;-<span class="kw">sd</span>(<span class="kw">g</span>(sj)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>sj)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))))</a>
<a class="sourceLine" id="cb24-19" title="19">    }</a>
<a class="sourceLine" id="cb24-20" title="20">  mat1[i]&lt;-<span class="kw">mean</span>(T)</a>
<a class="sourceLine" id="cb24-21" title="21">  ssd[i]&lt;-<span class="kw">mean</span>(sd)</a>
<a class="sourceLine" id="cb24-22" title="22">}  </a>
<a class="sourceLine" id="cb24-23" title="23"><span class="kw">mean</span>(mat1)</a></code></pre></div>
<pre><code>## [1] 0.5248023</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="kw">mean</span>(ssd)</a></code></pre></div>
<pre><code>## [1] 0.0307577</code></pre>
<p>The value of <span class="math inline">\(\theta\)</span> is about 0.524 and the variance is 0.03.The later is less than the value by importance sampling,which makes me interested. Here is some extra work I had done. I set <span class="math inline">\(\mathbf{k=1}\)</span> and run. Of course,the value is equal to before.</p>
<pre><code>## [1] 0.5248053</code></pre>
<pre><code>## [1] 0.09682816</code></pre>
<p>I set <span class="math inline">\(\mathbf{k=2}\)</span> and run:</p>
<pre><code>## [1] 0.5248052</code></pre>
<pre><code>## [1] 0.06925284</code></pre>
<p>Last we set <span class="math inline">\(\mathbf{k=10}\)</span> and run:</p>
<pre><code>## [1] 0.5247867</code></pre>
<pre><code>## [1] 0.01559273</code></pre>
<p>To make the result clear ,a form is created:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">k.value&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb34-2" title="2">mean.value&lt;-<span class="kw">c</span>(<span class="fl">0.524</span>,<span class="fl">0.524</span>,<span class="fl">0.524</span>,<span class="fl">0.524</span>)</a>
<a class="sourceLine" id="cb34-3" title="3">sd.value&lt;-<span class="kw">c</span>(<span class="fl">0.0968</span>,<span class="fl">0.0692</span>,<span class="fl">0.0307</span>,<span class="fl">0.0156</span>)</a>
<a class="sourceLine" id="cb34-4" title="4">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">cbind</span>(k.value,mean.value,sd.value))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">k.value</th>
<th align="right">mean.value</th>
<th align="right">sd.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.524</td>
<td align="right">0.0968</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.524</td>
<td align="right">0.0692</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">0.524</td>
<td align="right">0.0307</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">0.524</td>
<td align="right">0.0156</td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(\textbf{Analysis}\)</span> From the form above we can know that stratified importance sampling can get a smaller variance comparing with importance sampling, and the value of <span class="math inline">\(\theta\)</span> is similar. As the number of divided regions increases,the variances decrease.We can get a smaller variance .</p>
</div>
</div>
<div id="the-homework-4" class="section level1">
<h1>The homework 4</h1>
<div id="questions-3" class="section level2">
<h2>Questions</h2>
<p>6.5 Suppose a <span class="math inline">\(95%\)</span> symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarilyequal to <span class="math inline">\(0.95\)</span>. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^{2}(2)\)</span> data with sample size <span class="math inline">\(n = 20\)</span>. Compare your t-interval results with the simulation results in Example <span class="math inline">\(6.4\)</span>. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
<p>6.6 Estimate the <span class="math inline">\(0.025\)</span>, <span class="math inline">\(0.05\)</span>, <span class="math inline">\(0.95\)</span>, and <span class="math inline">\(0.975\)</span> quantiles of the skewness<span class="math inline">\(\sqrt(b_{1})\)</span> under normality by a Monte Carlo experiment. Compute the standard error of the estimates from <span class="math inline">\((2.14)\)</span> using the normal approximation for the density (with exact variance formula). Compare the estimated quantiles with the quantiles of the large sample approximation <span class="math inline">\(\sqrt(b_{1})\thickapprox N(0,6/n)\)</span></p>
</div>
<div id="question-1" class="section level2">
<h2>Question 1</h2>
<p><span class="math inline">\(\textbf{1.Thought}\)</span></p>
<p>According to the formula</p>
<p><span class="math display">\[
\bar{x} \pm t_{1-\alpha / 2}(n-1) s / \sqrt{n}
\]</span> we can cluculate 95% confidence interval of <span class="math inline">\(x\)</span>.Then we compare the average value of <span class="math inline">\(\chi^{2}(2)\)</span>,which is 2,with Upper and lower bound. We do it 10000 times and take average to get proportion.</p>
<p><span class="math inline">\(\textbf{2.Program}\)</span></p>
<p>First, a function is written to get confidence interval.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1">wf1&lt;-<span class="cf">function</span>(n,alpha){</a>
<a class="sourceLine" id="cb35-2" title="2">x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb35-3" title="3">UCL11 &lt;-<span class="st"> </span><span class="kw">mean</span>(x)<span class="op">+</span><span class="kw">sd</span>(x) <span class="op">*</span><span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n)</a>
<a class="sourceLine" id="cb35-4" title="4">UCL12&lt;-<span class="kw">mean</span>(x)<span class="op">+</span><span class="st"> </span><span class="kw">sd</span>(x) <span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n)</a>
<a class="sourceLine" id="cb35-5" title="5"><span class="kw">c</span>(UCL11,UCL12)</a>
<a class="sourceLine" id="cb35-6" title="6">}</a></code></pre></div>
<p>Then, A loop of 10000 times is done to calculate the probablity of UCL11&lt;2 and UCL12&gt;2,Which is our coverage probability.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1">n=<span class="dv">10000</span></a>
<a class="sourceLine" id="cb36-2" title="2">data1=<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow =</span> <span class="dv">2</span>,<span class="dt">ncol =</span> n)</a>
<a class="sourceLine" id="cb36-3" title="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb36-4" title="4">  data1[,i]=<span class="kw">wf1</span>(<span class="dv">20</span>,<span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb36-5" title="5">}</a>
<a class="sourceLine" id="cb36-6" title="6"><span class="kw">length</span>(<span class="kw">which</span>(data1[<span class="dv">1</span>,]<span class="op">&lt;</span><span class="dv">2</span><span class="op">&amp;</span>data1[<span class="dv">2</span>,]<span class="op">&gt;</span><span class="dv">2</span>))<span class="op">/</span>n</a></code></pre></div>
<pre><code>## [1] 0.9167</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1">new.t1&lt;-<span class="kw">mean</span>(data1[<span class="dv">1</span>,])</a>
<a class="sourceLine" id="cb38-2" title="2">new.t2&lt;-<span class="kw">mean</span>(data1[<span class="dv">2</span>,])</a>
<a class="sourceLine" id="cb38-3" title="3">new.t1</a></code></pre></div>
<pre><code>## [1] 1.105969</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1">new.t2</a></code></pre></div>
<pre><code>## [1] 2.893127</code></pre>
<p><span class="math inline">\(\textbf{3.Analysis}\)</span></p>
<p>The coverage probability is about <span class="math inline">\(0.91\)</span>,which is lower than 0.95. The reason is that t distribution is a heavy tail distribution.</p>
<p><span class="math inline">\(\textbf{Compared with example 6.4}\)</span>,when the data comes from a normal distribution, the probability interval of coverage is approximately 95.6%. But when the data is not normally distributed, from the chi-square distribution, the t-distribution is still a good estimate.</p>
</div>
<div id="question2" class="section level2">
<h2>Question2</h2>
<p><span class="math inline">\(\textbf{1.Thought}\)</span></p>
<p>I considered both large and small samples. Each case consists of three cycles. The first layer of the loop is a different q quantile. The second layer of the loop is a different n.Â The third layer of the cycle is repeated 1000 times.</p>
<p><span class="math inline">\(\textbf{2.Program}\)</span></p>
<p><span class="math inline">\(\textbf{2.1 Small sample}\)</span></p>
<p>1.The following function is used to calculate critical values,and it is solved in cv.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">cv&lt;-<span class="cf">function</span>(alpha){</a>
<a class="sourceLine" id="cb42-2" title="2">n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>)<span class="co">#sizes of samples</span></a>
<a class="sourceLine" id="cb42-3" title="3">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(alpha, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))<span class="co">#crit. values for each n</span></a>
<a class="sourceLine" id="cb42-4" title="4"><span class="kw">round</span>(cv,<span class="dv">5</span>)<span class="co">#Five decimal places</span></a>
<a class="sourceLine" id="cb42-5" title="5">}</a></code></pre></div>
<p>2.This function is used to calculate sample skewness coeff.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="co">#write a function to compute the sample skewness coeff.</span></a>
<a class="sourceLine" id="cb43-2" title="2">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb43-3" title="3">xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb43-4" title="4">m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)<span class="co">#molecule</span></a>
<a class="sourceLine" id="cb43-5" title="5">m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)<span class="co">#for calculating Denominator</span></a>
<a class="sourceLine" id="cb43-6" title="6"><span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )<span class="co">#return skewness</span></a>
<a class="sourceLine" id="cb43-7" title="7">}</a></code></pre></div>
<p>3.There are three loops.The first loop includes six different sample numbers.The second loop includes four quantiles.The third loop average 1000 results.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1">n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>)</a>
<a class="sourceLine" id="cb44-2" title="2">var&lt;-p.reject &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="kw">length</span>(n)) <span class="co">#to store sim. results</span></a>
<a class="sourceLine" id="cb44-3" title="3">m &lt;-<span class="st"> </span><span class="dv">100000</span> <span class="co">#num. repl. each sim.</span></a>
<a class="sourceLine" id="cb44-4" title="4">num&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb44-5" title="5"><span class="cf">for</span> (alpha <span class="cf">in</span> <span class="kw">c</span>(<span class="fl">0.9875</span>,<span class="fl">0.975</span>,<span class="fl">0.525</span>,<span class="fl">0.5125</span>)){</a>
<a class="sourceLine" id="cb44-6" title="6">    num&lt;-num<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb44-7" title="7">    cv1&lt;-<span class="kw">cv</span>(alpha)</a>
<a class="sourceLine" id="cb44-8" title="8">    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</a>
<a class="sourceLine" id="cb44-9" title="9">        sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#test decisions</span></a>
<a class="sourceLine" id="cb44-10" title="10">        <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb44-11" title="11">            x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i])</a>
<a class="sourceLine" id="cb44-12" title="12">            <span class="co">#test decision is 1 (reject) or 0</span></a>
<a class="sourceLine" id="cb44-13" title="13">            sktests[j] &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv1[i] )</a>
<a class="sourceLine" id="cb44-14" title="14">         }</a>
<a class="sourceLine" id="cb44-15" title="15">         p.reject[num,i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests) <span class="co">#proportion  rejected</span></a>
<a class="sourceLine" id="cb44-16" title="16">         sigma&lt;-<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n[i]<span class="op">-</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>((n[i]<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n[i]<span class="op">+</span><span class="dv">3</span>)))</a>
<a class="sourceLine" id="cb44-17" title="17">         var[num,i]&lt;-alpha<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>alpha)<span class="op">/</span>(n[i]<span class="op">*</span>(<span class="kw">exp</span>(<span class="op">-</span>cv1[i]<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span><span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(sigma<span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)))<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb44-18" title="18">    }</a>
<a class="sourceLine" id="cb44-19" title="19">}</a>
<a class="sourceLine" id="cb44-20" title="20">p.reject</a></code></pre></div>
<pre><code>##         [,1]    [,2]    [,3]    [,4]    [,5]    [,6]
## [1,] 0.02934 0.02976 0.02912 0.02885 0.02683 0.02560
## [2,] 0.05458 0.05381 0.05271 0.05172 0.05105 0.05000
## [3,] 0.94753 0.94654 0.94749 0.94712 0.94875 0.95204
## [4,] 0.97394 0.97199 0.97253 0.97390 0.97352 0.97530</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1">var</a></code></pre></div>
<pre><code>##            [,1]       [,2]        [,3]        [,4]         [,5]
## [1,] 0.39570706 0.13179668 0.064536751 0.025120789 0.0066633615
## [2,] 0.23953417 0.07977973 0.039061073 0.015207050 0.0040334014
## [3,] 0.05280143 0.01758680 0.008610982 0.003352102 0.0008891185
## [4,] 0.05274487 0.01756797 0.008601759 0.003348508 0.0008881648
##              [,6]
## [1,] 2.796075e-04
## [2,] 1.692196e-04
## [3,] 3.730322e-05
## [4,] 3.726311e-05</code></pre>
<p><span class="math inline">\(\textbf{ Analysis}\)</span></p>
<p>In the case of small samples, we take the variance as <span class="math display">\[
\operatorname{Var}(\sqrt{b_{1}})=\frac{6(n-2)}{(n+1)(n+3)}
\]</span>. The result is very good, close to 0.025, 0.05, 0.95, and 0.975.As n increases, standard error of quantile becomes smaller.</p>
</div>
</div>
<div id="the-homework-5" class="section level1">
<h1>The homework 5</h1>
<div id="questions-4" class="section level2">
<h2>Questions</h2>
<p><span class="math inline">\(\textbf{6.7}\)</span> Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(Beta(\alpha,\alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(Î½)\)</span>?</p>
<p><span class="math inline">\(\textbf{6.A}\)</span> Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level Î±, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) <span class="math inline">\(\chi^{2}(1)\)</span>, (ii) Uniform<span class="math inline">\((0,2)\)</span>, and (iii) Exponential(rate=1). In each case, test <span class="math inline">\(H_{0}:u=u_{0}\)</span> vs <span class="math inline">\(H_{0}:u\ne u_{0}\)</span>, where Âµ 0 is the mean of <span class="math inline">\(\chi^{2}(1)\)</span>, Uniform<span class="math inline">\((0,2)\)</span>, and Exponential(1), respectively.</p>
<p><span class="math inline">\(\textbf{Discussion}\)</span> If we obtain the powers for two methods under a particular simulation setting with <span class="math inline">\(10,000\)</span> experiments: say, <span class="math inline">\(0.651\)</span> for one method and <span class="math inline">\(0.676\)</span> for another method. Can we say the powers are different at <span class="math inline">\(0.05\)</span> level?</p>
<p>*What is the corresponding hypothesis test problem?</p>
<p>*What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?</p>
<p>*What information is needed to test your hypothesis?</p>
</div>
<div id="question-1-1" class="section level2">
<h2>Question 1</h2>
<p><span class="math inline">\(\textbf{1.Thought}\)</span></p>
<p>I analyzed the skewness of the Beta distribution from three cases:</p>
<p>*1.<span class="math inline">\(\alpha\ne\beta\)</span>,<span class="math inline">\(\alpha=2\)</span> and <span class="math inline">\(\beta\)</span> ranges from 2 to 10.</p>
<p>*2.<span class="math inline">\(\alpha=\beta\)</span>,and <span class="math inline">\(\alpha\)</span> ranges from 2 to 10.</p>
<p>*3.Mixed distribution,<span class="math inline">\((1 âˆ’ \epsilon)Beta(\alpha_{1},\beta_{1}) + \epsilon Beta(\alpha_{2},\beta_{2})\)</span></p>
<p>I analyzed the skewness of the t distribution from two cases:</p>
<p>*1.The freedom of t distribution ranges from 2 to 50</p>
<p>*2.Mixed distribution with t(2) and t(80),<span class="math inline">\((1 âˆ’ \epsilon)t(2) + \epsilon t(80)\)</span></p>
<p><span class="math inline">\(\textbf{2.Program}\)</span></p>
<p><span class="math inline">\(\textbf{Work of Beta distribution}\)</span></p>
<p>Prepare before starting.I draw two graph of Beta distribution with different parameters.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb48-2" title="2"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb48-3" title="3">break1 =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.02</span>)</a>
<a class="sourceLine" id="cb48-4" title="4"></a>
<a class="sourceLine" id="cb48-5" title="5"><span class="kw">hist</span>(<span class="kw">rbeta</span>(<span class="dv">3000</span>,<span class="dv">10</span>,<span class="dv">10</span>),<span class="dt">prob=</span><span class="ot">TRUE</span>,break1,<span class="dt">col =</span> <span class="st">&#39;yellow&#39;</span>)</a>
<a class="sourceLine" id="cb48-6" title="6"><span class="kw">lines</span>(break1,<span class="kw">dbeta</span>(break1,<span class="dv">10</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb48-7" title="7"></a>
<a class="sourceLine" id="cb48-8" title="8"><span class="kw">hist</span>(<span class="kw">rbeta</span>(<span class="dv">3000</span>,<span class="dv">2</span>,<span class="dv">6</span>),<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.02</span>),<span class="dt">col =</span> <span class="st">&#39;yellow&#39;</span>)</a>
<a class="sourceLine" id="cb48-9" title="9"><span class="kw">lines</span>(break1,<span class="kw">dbeta</span>(break1,<span class="dv">2</span>,<span class="dv">6</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the picture above ,we can know that when <span class="math inline">\(\alpha=\beta\)</span>, the image is symmetrical and Skewness is equal to 0.When <span class="math inline">\(\alpha\ne\beta\)</span>, the image is not symmetrical and Skewness is not equal to 0.</p>
<p>The following funtion sk() is used to calculate skewness.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb49-2" title="2">  <span class="co">#computes the sample skewness coeff.</span></a>
<a class="sourceLine" id="cb49-3" title="3">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb49-4" title="4">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb49-5" title="5">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb49-6" title="6">  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb49-7" title="7">}</a></code></pre></div>
<p><span class="math inline">\(\textbf{Case1}\)</span> <span class="math inline">\(\alpha\ne\beta\)</span>,<span class="math inline">\(\alpha=2\)</span> and <span class="math inline">\(\beta\)</span> ranges from 2 to 10.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb50-2" title="2">n &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb50-3" title="3">m &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb50-4" title="4">seq1 &lt;-<span class="kw">seq</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb50-5" title="5">N &lt;-<span class="st"> </span><span class="kw">length</span>(seq1)</a>
<a class="sourceLine" id="cb50-6" title="6">pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N) <span class="co">#Store power value</span></a>
<a class="sourceLine" id="cb50-7" title="7"><span class="co">#critical value for the skewness test</span></a>
<a class="sourceLine" id="cb50-8" title="8">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb50-9" title="9"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { </a>
<a class="sourceLine" id="cb50-10" title="10">  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb50-11" title="11">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></a>
<a class="sourceLine" id="cb50-12" title="12">    x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">30</span>, <span class="dv">2</span>, seq1[j])</a>
<a class="sourceLine" id="cb50-13" title="13">    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb50-14" title="14">  }</a>
<a class="sourceLine" id="cb50-15" title="15">  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb50-16" title="16">}</a>
<a class="sourceLine" id="cb50-17" title="17"><span class="co">#plot power vs seq1</span></a>
<a class="sourceLine" id="cb50-18" title="18"><span class="kw">plot</span>(seq1, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</a>
<a class="sourceLine" id="cb50-19" title="19">     <span class="dt">xlab =</span> <span class="kw">bquote</span>(seq1), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">col=</span><span class="st">&#39;blue&#39;</span>)</a>
<a class="sourceLine" id="cb50-20" title="20"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">0.05</span>, <span class="dt">lty =</span> <span class="dv">4</span>) <span class="co">#Increase the confidence level of 0.05</span></a>
<a class="sourceLine" id="cb50-21" title="21">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></a>
<a class="sourceLine" id="cb50-22" title="22"><span class="kw">lines</span>(seq1, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>,<span class="dt">col=</span><span class="st">&#39;violet&#39;</span>)</a>
<a class="sourceLine" id="cb50-23" title="23"><span class="kw">lines</span>(seq1, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>,<span class="dt">col=</span><span class="st">&#39;violet&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAWlBMVEUAAAAAADoAAGYAAP8AOjoAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmkJBmtv+QOgCQZgCQtpCQ2/+2ZgC2/7a2///bkDrb///ugu7/tmb/25D//7b//9v///8+4wN+AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAH3klEQVR4nO2djXabOBBGSbVN2ng32Y27LNjh/V9zkWaEsWP8iR8hQb97TmLaUpFcj0YSmpCiIQ8pUn8BuUNBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggALCyo2QypByzYXDwoCUBBgZUHju3ZqGEEACgJQEICCABQEoCAABQEoCEBBAAoCRBJ0LIrnz/d2RfG2SHMJiSOo/P5f6+i5ac6H1wWaS0kUQZ/vrZb66aMRVXObS0oUQedD27Pqb/82/vO85pLCCAJEzkFO1ezmUsJRDMB5EICCALEFlRzFxl2ON+3TNBcPCgJEEuSG+JaBDPTbCyoLnR/WBSeKd+jNn7nUuIdbrApcrN6DEYQo/RqMOWiA80FGsYH4oaC1m4sHBQEoCEBBAAoCUBCAggAUBBgvaHAnJ851UzNeUG8lusZ1UzOhiw0t0ONcNzVTIqgAdwsftcKb9mmaiwcFASZ1secVr5uaCRGkSchVt8S/bmomd7HzYdZgtnNBNogYQUMnnl6mDfHTrpuaKUmaE0VwYhtCs8exXQtq7L7OYHFdj9PL4El7F/S4p3WrkeEFyZ4FHfFaTPcLNx1Bxhj7MmkmjUf488FuGW5GkMq4+iv9iLYWO7YWtyLIy3Ci/If+wxRBLsUMbip7yuJ1I4JaDVVlP5v2VWTJ60RB+jMGsJ+dXv7YgqAuWoy4MU6W8WE15Z60fNdHGEOf78NzgYSC+gnHHmvUGPdqvBxjpuag858SOvPuvCYQpGL6Ccdo17qWo1E0dRTzETRUGnVNPoXkKsYmHD2ojNG/8e6cKJ+HRn6hvRzkOk4ZMpX+2kqye9JejLEvzo1LNT5B6+vNKNbMumk/8b79yOsug8s1TaO514aK6UatLh835s7//D3uSUt3alzk6LFNNJKJr0axL+y8kNyP3ZWLGndgpHtZPy5Pgxb2XUgu47dKqLrpseYjKMey6zJgJ8KOTKafoM1wwrnDTgvJ/VCkA5TxI7sO8YHRY9lnBIkZnQ33hIyIHM8eC8mN5uNKhvOqulgJjxzP3grJ3fqhW1DJsD46avrsbB4k+cbmmt70b3TU9NmXIJ+VXRDJQnQuexB0CREZrarmdkE1gx0I6s0GdTkxK+ncsHVBTky3qDKB64cRbFmQmLiM6e1Htagcy4YFuWV5VfXuAzZL9i1lq4L66wjTiaIgz9U6ovJdraIghyRmuePlJztm9pR5gC0Juqw4ZbS6HbEWT9CWlQXNuWl/me9I9MQRcst2IsjPdy7Rs+xXNMCWBFXdNsRK0WPZkiBdoi+0Cg1kK4JkGaFD+VrRY9mIICOznUhD+SOyF3S5/b5u7vHkLsjX7Oht+PXJXJDWFFTdfs3qZC2oK/ry69IEZLs3382ZJYJWzz2eXPfmZbledZVwifRkurNqurqmS01TKrLbm/f3UbWCJ13oKLlFkHYtX5SR3E+6vflC7330D409rKqiaOXIH29OSHEYRdCEvfmua+lSNGXe6ZN0HtQrKtW806tayYSUgnrFpT4pV34HcNmrzSC2oAeF5H6WrHUGuqTISY4l4T1pv87q9iay6lqehF2sF0FNk13X8mSSg/KUY0m6WL3zoxHZketiNRuSLTU2QwxBAYvVcY0GnpfktCmnB0TQuEb3JihgsTqu0d0JwovVcY3uT9DCjVLQMudRUI6nTTx92UYpaJnz9idoT1AQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCDA4oLc3mLgrwnCz2yUB6UHPOa6LAKe9Hz66fZi6jEPpl9a0Od7e+0y7MndNX4walO3p5wPsDn7ANEaGdJHQdtHjtbBhpYWJM95HaqOueJ8wIJkpwk29/luFR4fe6xly1yaBOdeiJODgt6g8vvfUNDpR9A7HSKoLl7ddueIt9ASR9Ax4PLt945zUP3t1yEkpQV1MdkPFufBT2SNIgjsKzpspGNBpe0VEh/okgGJ11mR6A5OQjEE1UHDTisnQNBT2NttQ/b0gt6WTASFxI8EeoAgp+bBE761tbC8kkcXK4NmQaVWoYDvXL4PmKoDoyKLJD3mccI4gqTiBr7d8k3D0+oMhnmcCHoEzKRtqgr4BZ4jclDiiaJ2nbDrhyw16rCVyzHkNA2xMuVSY3dQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEGArQnSMsP12JggLTNckW0Jquf8FuFpZCjIFv7q753W/Xa7mf7Pj4+uzHBN8hPkSllsvaGtLnMVG7Z0o9Z6AwrqFJwPr/InrXiiIMXnYSnhae1cVZlRkP4ww5srDHJFeiUFfeX49NEVgWkoUVCf8+GteyCYHDAHeVzA2E9OyVEPTi8U5Kl9jaOdB0nZZXvwF7vYYwJ/rGVxKAhAQYDNCEoFBQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQE+B9hgeNuadf4/QAAAABJRU5ErkJggg==" /><!-- --></p>
<p><span class="math inline">\(\textbf{Analysis}\)</span> :From the graph above ,we can infer that when <span class="math inline">\(\alpha \ne\beta\)</span>,the distributon is skewed.There exists a elbow point when<span class="math inline">\(\alpha=2,\beta=3.2\)</span>. When $$ is less than <span class="math inline">\(3.2\)</span>, the image is considered to have no skewness at a confidence level of 0.05.</p>
<p><span class="math inline">\(\textbf{Case2}\)</span> <span class="math inline">\(\alpha=\beta\)</span>,and <span class="math inline">\(\alpha\)</span> ranges from 2 to 10.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb51-2" title="2">n &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb51-3" title="3">m &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb51-4" title="4">seq1 &lt;-<span class="kw">seq</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="fl">.2</span>)</a>
<a class="sourceLine" id="cb51-5" title="5">N &lt;-<span class="st"> </span><span class="kw">length</span>(seq1)</a>
<a class="sourceLine" id="cb51-6" title="6">pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb51-7" title="7"><span class="co">#critical value for the skewness test</span></a>
<a class="sourceLine" id="cb51-8" title="8">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb51-9" title="9"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { </a>
<a class="sourceLine" id="cb51-10" title="10">  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb51-11" title="11">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></a>
<a class="sourceLine" id="cb51-12" title="12">    x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">30</span>, seq1[j], seq1[j])</a>
<a class="sourceLine" id="cb51-13" title="13">    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb51-14" title="14">  }</a>
<a class="sourceLine" id="cb51-15" title="15">  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb51-16" title="16">}</a>
<a class="sourceLine" id="cb51-17" title="17"><span class="co">#plot power vs epsilon</span></a>
<a class="sourceLine" id="cb51-18" title="18"><span class="kw">plot</span>(seq1, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</a>
<a class="sourceLine" id="cb51-19" title="19">     <span class="dt">xlab =</span> <span class="kw">bquote</span>(seq1), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.2</span>),<span class="dt">col=</span><span class="st">&#39;blue&#39;</span>)</a>
<a class="sourceLine" id="cb51-20" title="20"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.05</span>, <span class="dt">lty =</span> <span class="dv">4</span>) <span class="co">#Increase the confidence level of 0.05</span></a>
<a class="sourceLine" id="cb51-21" title="21">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></a>
<a class="sourceLine" id="cb51-22" title="22"><span class="kw">lines</span>(seq1, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>,<span class="dt">col=</span><span class="st">&#39;violet&#39;</span>)</a>
<a class="sourceLine" id="cb51-23" title="23"><span class="kw">lines</span>(seq1, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>,<span class="dt">col=</span><span class="st">&#39;violet&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(\textbf{Analysis}\)</span>:From the preparing work ,we know that the graph is Symmetrical when <span class="math inline">\(\alpha=\beta\)</span>.Further, because power value is less than 0.05,from the above figure we kan know that the Beta distribution is not skewed.</p>
<p><span class="math inline">\(\textbf{Case3}\)</span> Mixed distribution,<span class="math inline">\((1 âˆ’ \epsilon)Beta(\alpha_{1},\beta_{1}) + \epsilon Beta(\alpha_{2},\beta_{2})\)</span></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb52-2" title="2">n &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb52-3" title="3">m &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb52-4" title="4">seq2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.15</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, <span class="fl">.05</span>))</a>
<a class="sourceLine" id="cb52-5" title="5">N &lt;-<span class="st"> </span><span class="kw">length</span>(seq2)</a>
<a class="sourceLine" id="cb52-6" title="6">pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb52-7" title="7"><span class="co">#critical value for the skewness test</span></a>
<a class="sourceLine" id="cb52-8" title="8">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb52-9" title="9"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></a>
<a class="sourceLine" id="cb52-10" title="10">  e &lt;-<span class="st"> </span>seq2[j]</a>
<a class="sourceLine" id="cb52-11" title="11">  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb52-12" title="12">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></a>
<a class="sourceLine" id="cb52-13" title="13">    par &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">10</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb52-14" title="14">                    <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</a>
<a class="sourceLine" id="cb52-15" title="15">    x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">30</span>, par, par)</a>
<a class="sourceLine" id="cb52-16" title="16">    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb52-17" title="17">  }</a>
<a class="sourceLine" id="cb52-18" title="18">  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb52-19" title="19">}</a>
<a class="sourceLine" id="cb52-20" title="20"><span class="co">#plot power vs epsilon</span></a>
<a class="sourceLine" id="cb52-21" title="21"><span class="kw">plot</span>(seq2, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</a>
<a class="sourceLine" id="cb52-22" title="22">     <span class="dt">xlab =</span> <span class="kw">bquote</span>(seq2),<span class="dt">col=</span><span class="st">&#39;blue&#39;</span>)</a>
<a class="sourceLine" id="cb52-23" title="23"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">0.05</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb52-24" title="24">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></a>
<a class="sourceLine" id="cb52-25" title="25"><span class="kw">lines</span>(seq2, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>,<span class="dt">col=</span><span class="st">&#39;violet&#39;</span>)</a>
<a class="sourceLine" id="cb52-26" title="26"><span class="kw">lines</span>(seq2, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>,<span class="dt">col=</span><span class="st">&#39;violet&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(\textbf{Analysis}\)</span>:When <span class="math inline">\(\epsilon\)</span> is equal to 0 or 1,the result Obeys Beta distribution,otherwise the result is skewed.The variance of Beta(2,2) is bigger than Beta(2,10),so the highest point occurs when <span class="math inline">\(\epsilon=0.8\)</span></p>
<p><span class="math inline">\(\textbf{Work of t distribution}\)</span></p>
<p><span class="math inline">\(\textbf{Case1}\)</span>The freedom of t distribution ranges from 2 to 50</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb53-2" title="2">n &lt;-<span class="st"> </span><span class="dv">50</span></a>
<a class="sourceLine" id="cb53-3" title="3">m &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb53-4" title="4">seq1 &lt;-<span class="kw">seq</span>(<span class="dv">2</span>, <span class="dv">50</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb53-5" title="5">N &lt;-<span class="st"> </span><span class="kw">length</span>(seq1)</a>
<a class="sourceLine" id="cb53-6" title="6">pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb53-7" title="7"><span class="co">#critical value for the skewness test</span></a>
<a class="sourceLine" id="cb53-8" title="8">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb53-9" title="9"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { </a>
<a class="sourceLine" id="cb53-10" title="10">  <span class="co">#print(j)</span></a>
<a class="sourceLine" id="cb53-11" title="11">  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb53-12" title="12">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></a>
<a class="sourceLine" id="cb53-13" title="13">    x &lt;-<span class="st"> </span><span class="kw">rt</span>(n,seq1[j])</a>
<a class="sourceLine" id="cb53-14" title="14">    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb53-15" title="15">  }</a>
<a class="sourceLine" id="cb53-16" title="16">  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb53-17" title="17">}</a>
<a class="sourceLine" id="cb53-18" title="18"><span class="co">#plot power vs epsilon</span></a>
<a class="sourceLine" id="cb53-19" title="19"><span class="kw">plot</span>(seq1, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</a>
<a class="sourceLine" id="cb53-20" title="20">     <span class="dt">xlab =</span> <span class="kw">bquote</span>(seq1),<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">col=</span><span class="st">&#39;blue&#39;</span>)</a>
<a class="sourceLine" id="cb53-21" title="21"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.05</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb53-22" title="22">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></a>
<a class="sourceLine" id="cb53-23" title="23"><span class="kw">lines</span>(seq1, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>,<span class="dt">col=</span><span class="st">&#39;violet&#39;</span>)</a>
<a class="sourceLine" id="cb53-24" title="24"><span class="kw">lines</span>(seq1, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>,<span class="dt">col=</span><span class="st">&#39;violet&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(\textbf{Analysis}\)</span> :When freedom is small,the t distribution is skewed because Stochasticity of Generate randomness of random numbers. But when freedom is big,t distribution is close to normal distribution and it is approximately not skewed.</p>
<p><span class="math inline">\(\textbf{Case2}\)</span> Mixed distribution with t(2) and t(80),<span class="math inline">\((1 âˆ’ \epsilon)t(2) + \epsilon t(80)\)</span></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb54-2" title="2">n &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb54-3" title="3">m &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb54-4" title="4">seq2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.15</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, <span class="fl">.05</span>))</a>
<a class="sourceLine" id="cb54-5" title="5">N &lt;-<span class="st"> </span><span class="kw">length</span>(seq2)</a>
<a class="sourceLine" id="cb54-6" title="6">pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb54-7" title="7"><span class="co">#critical value for the skewness test</span></a>
<a class="sourceLine" id="cb54-8" title="8">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb54-9" title="9"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></a>
<a class="sourceLine" id="cb54-10" title="10">  e &lt;-<span class="st"> </span>seq2[j]</a>
<a class="sourceLine" id="cb54-11" title="11">  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb54-12" title="12">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></a>
<a class="sourceLine" id="cb54-13" title="13">    par &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">80</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb54-14" title="14">                    <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</a>
<a class="sourceLine" id="cb54-15" title="15">    x &lt;-<span class="st"> </span><span class="kw">rt</span>(<span class="dv">30</span>, par)</a>
<a class="sourceLine" id="cb54-16" title="16">    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb54-17" title="17">  }</a>
<a class="sourceLine" id="cb54-18" title="18">  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb54-19" title="19">}</a>
<a class="sourceLine" id="cb54-20" title="20"><span class="co">#plot power vs epsilon</span></a>
<a class="sourceLine" id="cb54-21" title="21"><span class="kw">plot</span>(seq2, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</a>
<a class="sourceLine" id="cb54-22" title="22">     <span class="dt">xlab =</span> <span class="kw">bquote</span>(seq2),<span class="dt">col=</span><span class="st">&#39;green&#39;</span>)</a>
<a class="sourceLine" id="cb54-23" title="23"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">0.05</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb54-24" title="24">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></a>
<a class="sourceLine" id="cb54-25" title="25"><span class="kw">lines</span>(seq2, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>,<span class="dt">col=</span><span class="st">&#39;yellow&#39;</span>)</a>
<a class="sourceLine" id="cb54-26" title="26"><span class="kw">lines</span>(seq2, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>,<span class="dt">col=</span><span class="st">&#39;yellow&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(\textbf{Analysis}\)</span>:When <span class="math inline">\(\epsilon\)</span> is equal to 1,the result Obeys t(80) and is not skewed,otherwise the result is skewed.When <span class="math inline">\(\epsilon\)</span> is equal to 0,the result Obeys t(2) and is skewed.</p>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<p><span class="math inline">\(\textbf{1.Thought}\)</span></p>
<p>When nominal significance level takes different values such as 0.025,0.05 and 0.1,I calculate empirical Type I error against three distributions,and compare it with nominal significance level.</p>
<p><span class="math inline">\(Case1\)</span>:when the sampled population is <span class="math inline">\(\chi^{2}(1)\)</span>:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb55-2" title="2">mu0 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb55-3" title="3">m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb55-4" title="4">p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#storage for p-values</span></a>
<a class="sourceLine" id="cb55-5" title="5">chisq.hat&lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb55-6" title="6">fw&lt;-<span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb55-7" title="7"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>){</a>
<a class="sourceLine" id="cb55-8" title="8">   <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb55-9" title="9">      x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb55-10" title="10">      ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">mu =</span> mu0)</a>
<a class="sourceLine" id="cb55-11" title="11">      p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb55-12" title="12">   }</a>
<a class="sourceLine" id="cb55-13" title="13"> chisq.hat[i]&lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>fw[i])</a>
<a class="sourceLine" id="cb55-14" title="14">}  </a>
<a class="sourceLine" id="cb55-15" title="15">se.hat1 &lt;-<span class="st"> </span><span class="kw">sqrt</span>(chisq.hat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>chisq.hat) <span class="op">/</span><span class="st"> </span>m)</a>
<a class="sourceLine" id="cb55-16" title="16"><span class="kw">print</span>(<span class="kw">c</span>(chisq.hat, se.hat1))</a></code></pre></div>
<pre><code>## [1] 0.024500000 0.056700000 0.097400000 0.001545954 0.002312685 0.002965017</code></pre>
<p>The result of <span class="math inline">\(\chi^{2}(1)\)</span> is close to nominal significance level .</p>
<p><span class="math inline">\(Case2\)</span>:when the sampled population is Uniform(0,2):</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb57-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb57-3" title="3">mu0 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb57-4" title="4">m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb57-5" title="5">p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#storage for p-values</span></a>
<a class="sourceLine" id="cb57-6" title="6">unif.hat&lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb57-7" title="7">fw&lt;-<span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb57-8" title="8"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>){</a>
<a class="sourceLine" id="cb57-9" title="9">    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb57-10" title="10">         x &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dv">0</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb57-11" title="11">         ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">mu =</span> mu0)</a>
<a class="sourceLine" id="cb57-12" title="12">         p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb57-13" title="13">    }</a>
<a class="sourceLine" id="cb57-14" title="14">  unif.hat[i]&lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>fw[i])</a>
<a class="sourceLine" id="cb57-15" title="15">}</a>
<a class="sourceLine" id="cb57-16" title="16">se.hat2 &lt;-<span class="st"> </span><span class="kw">sqrt</span>(unif.hat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>unif.hat) <span class="op">/</span><span class="st"> </span>m)</a>
<a class="sourceLine" id="cb57-17" title="17"><span class="kw">print</span>(<span class="kw">c</span>(unif.hat, se.hat2))</a></code></pre></div>
<pre><code>## [1] 0.026000000 0.050400000 0.102600000 0.001591352 0.002187689 0.003034357</code></pre>
<p>The result of Uniform(0,2) is also close to nominal significance level .</p>
<p><span class="math inline">\(Case3\)</span>:when the sampled population is exponential(rate=1):</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb59-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb59-3" title="3">mu0 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb59-4" title="4">m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb59-5" title="5">p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#storage for p-values</span></a>
<a class="sourceLine" id="cb59-6" title="6">exp.hat&lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb59-7" title="7">fw&lt;-<span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb59-8" title="8"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>){</a>
<a class="sourceLine" id="cb59-9" title="9">    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb59-10" title="10">        x &lt;-<span class="st"> </span><span class="kw">rexp</span>(n, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb59-11" title="11">        ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">mu =</span> mu0)</a>
<a class="sourceLine" id="cb59-12" title="12">         p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb59-13" title="13">    }</a>
<a class="sourceLine" id="cb59-14" title="14">    exp.hat[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>fw[i])</a>
<a class="sourceLine" id="cb59-15" title="15">}</a>
<a class="sourceLine" id="cb59-16" title="16"></a>
<a class="sourceLine" id="cb59-17" title="17">se.hat3 &lt;-<span class="st"> </span><span class="kw">sqrt</span>(exp.hat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>exp.hat) <span class="op">/</span><span class="st"> </span>m)</a>
<a class="sourceLine" id="cb59-18" title="18"><span class="kw">print</span>(<span class="kw">c</span>(exp.hat, se.hat3))</a></code></pre></div>
<pre><code>## [1] 0.028600000 0.051100000 0.097500000 0.001666795 0.002202017 0.002966374</code></pre>
<p>The result of exponential(rate=1) is also close to nominal significance level .</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="kw">data.frame</span>(fw,chisq.hat,unif.hat,exp.hat)</a></code></pre></div>
<pre><code>##      fw chisq.hat unif.hat exp.hat
## 1 0.025    0.0245   0.0260  0.0286
## 2 0.050    0.0567   0.0504  0.0511
## 3 0.100    0.0974   0.1026  0.0975</code></pre>
<p><span class="math inline">\(Analysis\)</span>:From the table above ,we get that the when sampled population is from <span class="math inline">\(\chi^{2}(1)\)</span>, Uniform(0,2),and exponential(rate=1),empirical Type I error rate of the t-test is approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>. The t-test is robust to mild departures from normality.</p>
</div>
<div id="question-3" class="section level2">
<h2>Question 3</h2>
<p><span class="math inline">\(\textbf{*Answer of question 1}\)</span>:</p>
<p><span class="math inline">\(H_{0}:\)</span> Two powers are same,power1=power2</p>
<p><span class="math inline">\(H_{1}:\)</span> Two powers are different,power<span class="math inline">\(\ne\)</span>power2</p>
<p><span class="math inline">\(\textbf{*Answer of question 2}\)</span>:</p>
<p>Text:Paired-t test.</p>
<p><span class="math inline">\(z_{i}=pow_{1}-pow_{2}\)</span></p>
<p><span class="math inline">\(\bar{z}=\frac{1}{n}\Sigma z_{i}\)</span></p>
<p>Statistics:<span class="math inline">\(T=\frac{\bar{z}\sqrt(n)}{s*}\sim t_{n-1}\)</span></p>
<p>Rejected domain:<span class="math inline">\(W_{0}={|T|=|\frac{\bar{z}\sqrt(n)}{s*}|&gt;t_{n-1,\frac{\alpha}{2}}}\)</span></p>
<p><span class="math inline">\(\textbf{*Answer of question 3}\)</span>:</p>
<p>Ten sets of experiments were performed, and the power values of the two methods were calculated for each experiment. Subtract them to get the value of z and calculate the variance of z.</p>
</div>
</div>
<div id="the-homework-6" class="section level1">
<h1>The homework 6</h1>
<div id="questions-5" class="section level2">
<h2>Questions</h2>
<p><span class="math inline">\(\textbf{7.6}\)</span>Efron and Tibshirani discuss the scor (bootstrap)test score data on 88 students who took examinations in five subjects [84, Table 7.1], [188, Table 1.2.1].The first two tests (mechanics, vectors) were closed book and the last three tests (algebra, analysis, statistics) were open book. Each row of the data frame is a set of scores (x i1 ,â€¦,x i5 ) for the i th student. Use a panel display to display the scatter plots for each pair of test scores. Compare the plot with the sample correlation matrix. Obtain bootstrap estimates of the standard errors for each of the following estimates: <span class="math inline">\(\hat{\rho}_{12}=\hat{\rho}(mec, vec)\)</span>,<span class="math inline">\(\hat{\rho}_{34}=\hat{\rho}(alg,ana),\)</span><em>{35}=(alg, sta),$</em>{45}=(ana, sta).</p>
<p><span class="math inline">\(\textbf{7.B}\)</span>Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness 0) and <span class="math inline">\(\chi^{2}(5)\)</span> distributions (positive skewness).</p>
</div>
<div id="program" class="section level2">
<h2>Program</h2>
</div>
<div id="question-1-2" class="section level2">
<h2>Question 1</h2>
<p>The covariance matrix is shown below:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="kw">library</span>(bootstrap) <span class="co">#for the score data</span></a>
<a class="sourceLine" id="cb63-2" title="2"><span class="kw">cor</span>(scor)</a></code></pre></div>
<pre><code>##           mec       vec       alg       ana       sta
## mec 1.0000000 0.5534052 0.5467511 0.4093920 0.3890993
## vec 0.5534052 1.0000000 0.6096447 0.4850813 0.4364487
## alg 0.5467511 0.6096447 1.0000000 0.7108059 0.6647357
## ana 0.4093920 0.4850813 0.7108059 1.0000000 0.6071743
## sta 0.3890993 0.4364487 0.6647357 0.6071743 1.0000000</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="co">#show a part of data</span></a>
<a class="sourceLine" id="cb65-2" title="2">scor[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,]</a></code></pre></div>
<pre><code>##   mec vec alg ana sta
## 1  77  82  67  67  81
## 2  63  78  80  70  81
## 3  75  73  71  66  81
## 4  55  72  63  70  68
## 5  63  63  65  70  63</code></pre>
<p>Draw a scatter plot between each two exams</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb67-2" title="2"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb67-3" title="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>){</a>
<a class="sourceLine" id="cb67-4" title="4">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>){</a>
<a class="sourceLine" id="cb67-5" title="5">    <span class="cf">if</span>(i<span class="op">!=</span>j <span class="op">&amp;</span><span class="st"> </span>i<span class="op">&lt;</span>j){</a>
<a class="sourceLine" id="cb67-6" title="6">    <span class="kw">plot</span>(scor[,i],scor[,j],<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)}</a>
<a class="sourceLine" id="cb67-7" title="7">  }</a>
<a class="sourceLine" id="cb67-8" title="8">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the scatter plot we can see that there is a clear linear correlation between every two courses.</p>
<p>We calculate <span class="math inline">\(\hat{\rho}_{12}\)</span> as follows.A scatter plot and a histogram are drawn to show the relationship between the calculated result and the real result.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1">N=<span class="dv">300</span> <span class="co"># Initialize the numbers of replicates</span></a>
<a class="sourceLine" id="cb68-2" title="2">hat.rho12&lt;-<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb68-3" title="3">n&lt;-<span class="kw">nrow</span>(scor)</a>
<a class="sourceLine" id="cb68-4" title="4"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb68-5" title="5">  samp&lt;-<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n,n,<span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb68-6" title="6">  hat.rho12[i]&lt;-<span class="kw">cor</span>(scor<span class="op">$</span>mec[samp],scor<span class="op">$</span>vec[samp])</a>
<a class="sourceLine" id="cb68-7" title="7">}</a>
<a class="sourceLine" id="cb68-8" title="8"><span class="co"># Get Standard deviation of Correlation coefficient</span></a>
<a class="sourceLine" id="cb68-9" title="9">hat.sd12&lt;-<span class="kw">mean</span>(hat.rho12)</a>
<a class="sourceLine" id="cb68-10" title="10"><span class="kw">print</span>(hat.sd12)</a></code></pre></div>
<pre><code>## [1] 0.5472503</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="co"># real Correlation coefficient</span></a>
<a class="sourceLine" id="cb70-2" title="2">real.rho12&lt;-<span class="kw">cor</span>(scor<span class="op">$</span>mec,scor<span class="op">$</span>vec)</a>
<a class="sourceLine" id="cb70-3" title="3"><span class="kw">print</span>(real.rho12)</a></code></pre></div>
<pre><code>## [1] 0.5534052</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="co">#plot and compare with real Correlation coefficient</span></a>
<a class="sourceLine" id="cb72-2" title="2"><span class="kw">plot</span>(hat.rho12,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">col=</span><span class="st">&#39;green&#39;</span>)</a>
<a class="sourceLine" id="cb72-3" title="3"><span class="kw">abline</span>(<span class="dt">h =</span> real.rho12, <span class="dt">lty =</span> <span class="dv">4</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1"><span class="co">#Draw a histogram and a true correlation coefficient vertical line</span></a>
<a class="sourceLine" id="cb73-2" title="2"><span class="kw">hist</span>(hat.rho12)</a>
<a class="sourceLine" id="cb73-3" title="3"><span class="kw">abline</span>(<span class="dt">v=</span>real.rho12,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We calculate <span class="math inline">\(\hat{\rho}_{34}\)</span> as follows.A scatter plot and a histogram are drawn to show the relationship between the calculated result and the real result.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1">hat.rho34&lt;-<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb74-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb74-3" title="3">  samp&lt;-<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n,n,<span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb74-4" title="4">  hat.rho34[i]&lt;-<span class="kw">cor</span>(scor<span class="op">$</span>alg[samp],scor<span class="op">$</span>ana[samp])</a>
<a class="sourceLine" id="cb74-5" title="5">}</a>
<a class="sourceLine" id="cb74-6" title="6"><span class="co"># Get Standard deviation of Correlation coefficient</span></a>
<a class="sourceLine" id="cb74-7" title="7">hat.sd34&lt;-<span class="kw">mean</span>(hat.rho34)</a>
<a class="sourceLine" id="cb74-8" title="8"><span class="kw">print</span>(hat.sd34)</a></code></pre></div>
<pre><code>## [1] 0.7106566</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1"><span class="co"># real Correlation coefficient</span></a>
<a class="sourceLine" id="cb76-2" title="2">real.rho34&lt;-<span class="kw">cor</span>(scor<span class="op">$</span>alg,scor<span class="op">$</span>ana)</a>
<a class="sourceLine" id="cb76-3" title="3"><span class="kw">print</span>(real.rho34)</a></code></pre></div>
<pre><code>## [1] 0.7108059</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="co">#plot and compare with real Correlation coefficient</span></a>
<a class="sourceLine" id="cb78-2" title="2"><span class="kw">plot</span>(hat.rho34,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">col=</span><span class="st">&#39;green&#39;</span>)</a>
<a class="sourceLine" id="cb78-3" title="3"><span class="kw">abline</span>(<span class="dt">h =</span> real.rho34, <span class="dt">lty =</span> <span class="dv">4</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1"><span class="co">#Draw a histogram and a true correlation coefficient vertical line</span></a>
<a class="sourceLine" id="cb79-2" title="2"><span class="kw">hist</span>(hat.rho34)</a>
<a class="sourceLine" id="cb79-3" title="3"><span class="kw">abline</span>(<span class="dt">v=</span>real.rho34,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We calculate <span class="math inline">\(\hat{\rho}_{35}\)</span> as follows.A scatter plot and a histogram are drawn to show the relationship between the calculated result and the real result.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1">hat.rho35&lt;-<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb80-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb80-3" title="3">  samp&lt;-<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n,n,<span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb80-4" title="4">  hat.rho35[i]&lt;-<span class="kw">cor</span>(scor<span class="op">$</span>alg[samp],scor<span class="op">$</span>sta[samp])</a>
<a class="sourceLine" id="cb80-5" title="5">}</a>
<a class="sourceLine" id="cb80-6" title="6"><span class="co"># Get Standard deviation of Correlation coefficient</span></a>
<a class="sourceLine" id="cb80-7" title="7">hat.sd35&lt;-<span class="kw">mean</span>(hat.rho35)</a>
<a class="sourceLine" id="cb80-8" title="8"><span class="kw">print</span>(hat.sd35)</a></code></pre></div>
<pre><code>## [1] 0.6601967</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="co"># real Correlation coefficient</span></a>
<a class="sourceLine" id="cb82-2" title="2">real.rho35&lt;-<span class="kw">cor</span>(scor<span class="op">$</span>alg,scor<span class="op">$</span>sta)</a>
<a class="sourceLine" id="cb82-3" title="3"><span class="kw">print</span>(real.rho35)</a></code></pre></div>
<pre><code>## [1] 0.6647357</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="co">#plot and compare with real Correlation coefficient</span></a>
<a class="sourceLine" id="cb84-2" title="2"><span class="kw">plot</span>(hat.rho35,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">col=</span><span class="st">&#39;green&#39;</span>)</a>
<a class="sourceLine" id="cb84-3" title="3"><span class="kw">abline</span>(<span class="dt">h =</span> real.rho35, <span class="dt">lty =</span> <span class="dv">4</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="co">#Draw a histogram and a true correlation coefficient vertical line</span></a>
<a class="sourceLine" id="cb85-2" title="2"><span class="kw">hist</span>(hat.rho35)</a>
<a class="sourceLine" id="cb85-3" title="3"><span class="kw">abline</span>(<span class="dt">v=</span>real.rho35,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We calculate <span class="math inline">\(\hat{\rho}_{45}\)</span> as follows.A scatter plot and a histogram are drawn to show the relationship between the calculated result and the real result.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1">hat.rho45&lt;-<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb86-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb86-3" title="3">  samp&lt;-<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n,n,<span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb86-4" title="4">  hat.rho45[i]&lt;-<span class="kw">cor</span>(scor<span class="op">$</span>ana[samp],scor<span class="op">$</span>sta[samp])</a>
<a class="sourceLine" id="cb86-5" title="5">}</a>
<a class="sourceLine" id="cb86-6" title="6"><span class="co"># Get Standard deviation of Correlation coefficient</span></a>
<a class="sourceLine" id="cb86-7" title="7">hat.sd45&lt;-<span class="kw">mean</span>(hat.rho45)</a>
<a class="sourceLine" id="cb86-8" title="8"><span class="kw">print</span>(hat.sd45)</a></code></pre></div>
<pre><code>## [1] 0.6080573</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="co"># real Correlation coefficient</span></a>
<a class="sourceLine" id="cb88-2" title="2">real.rho45&lt;-<span class="kw">cor</span>(scor<span class="op">$</span>ana,scor<span class="op">$</span>sta)</a>
<a class="sourceLine" id="cb88-3" title="3"><span class="kw">print</span>(real.rho45)</a></code></pre></div>
<pre><code>## [1] 0.6071743</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="co">#plot and compare with real Correlation coefficient</span></a>
<a class="sourceLine" id="cb90-2" title="2"><span class="kw">plot</span>(hat.rho45,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">col=</span><span class="st">&#39;green&#39;</span>)</a>
<a class="sourceLine" id="cb90-3" title="3"><span class="kw">abline</span>(<span class="dt">h =</span> real.rho45, <span class="dt">lty =</span> <span class="dv">4</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1"><span class="co">#Draw a histogram and a true correlation coefficient vertical line</span></a>
<a class="sourceLine" id="cb91-2" title="2"><span class="kw">hist</span>(hat.rho45)</a>
<a class="sourceLine" id="cb91-3" title="3"><span class="kw">abline</span>(<span class="dt">v=</span>real.rho45,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(\textbf{Analysis}\)</span>: When the number of samples is small, multiple sampling experiments can be performed using the bootstrap method. The experimental results are very similar to the real results, indicating the effectiveness of the method.</p>
</div>
<div id="question-2-1" class="section level2">
<h2>Question 2</h2>
<p>Calculate the skewness with the following function</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x,j) {</a>
<a class="sourceLine" id="cb92-2" title="2">  <span class="co">#computes the sample skewness coeff.</span></a>
<a class="sourceLine" id="cb92-3" title="3">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x[j])</a>
<a class="sourceLine" id="cb92-4" title="4">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x[j] <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb92-5" title="5">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x[j] <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb92-6" title="6">  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb92-7" title="7">}</a></code></pre></div>
<p><span class="math inline">\(\text{Normal distribution}\)</span></p>
<p>We take a sample with a normal distribution of N(0,2), the sample size is 20, and each time we do bootstrap 1000 times, we cycle 1000 experiments. The coverage of the interval is calculated based on the experimental results.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1">me&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb93-2" title="2">n&lt;-<span class="dv">20</span></a>
<a class="sourceLine" id="cb93-3" title="3">m&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb93-4" title="4"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb93-5" title="5"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb93-6" title="6">nor.norm&lt;-nor.basic&lt;-nor.perc&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb93-7" title="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb93-8" title="8">  data.nor&lt;-<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb93-9" title="9">  nor.ske&lt;-<span class="kw">boot</span>(data.nor,<span class="dt">statistic=</span>sk,<span class="dt">R=</span><span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb93-10" title="10">  nor&lt;-<span class="st"> </span><span class="kw">boot.ci</span>(nor.ske,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb93-11" title="11">  nor.norm[i,]&lt;-nor<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>];</a>
<a class="sourceLine" id="cb93-12" title="12">  nor.basic[i,]&lt;-nor<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>];</a>
<a class="sourceLine" id="cb93-13" title="13">  nor.perc[i,]&lt;-nor<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>];</a>
<a class="sourceLine" id="cb93-14" title="14">}</a>
<a class="sourceLine" id="cb93-15" title="15"><span class="co">#Calculate the coverage probability of a normal distribution</span></a>
<a class="sourceLine" id="cb93-16" title="16"><span class="kw">cat</span>(<span class="st">&#39;norm =&#39;</span>,<span class="kw">mean</span>(nor.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span>me <span class="op">&amp;</span><span class="st"> </span>nor.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span>me),</a>
<a class="sourceLine" id="cb93-17" title="17">    <span class="st">&#39;basic =&#39;</span>,<span class="kw">mean</span>(nor.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span>me <span class="op">&amp;</span><span class="st"> </span>nor.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span>me),</a>
<a class="sourceLine" id="cb93-18" title="18">    <span class="st">&#39;perc =&#39;</span>,<span class="kw">mean</span>(nor.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span>me <span class="op">&amp;</span><span class="st"> </span>nor.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span>me))</a></code></pre></div>
<pre><code>## norm = 0.919 basic = 0.91 perc = 0.977</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="co">#Calculate the probability of the left side of the normal distribution</span></a>
<a class="sourceLine" id="cb95-2" title="2"><span class="kw">cat</span>(<span class="st">&#39;norm.left=&#39;</span>,<span class="kw">mean</span>(nor.norm[,<span class="dv">1</span>]<span class="op">&gt;=</span>me ),</a>
<a class="sourceLine" id="cb95-3" title="3">    <span class="st">&#39;basic.left =&#39;</span>,<span class="kw">mean</span>(nor.basic[,<span class="dv">1</span>]<span class="op">&gt;=</span>me ),</a>
<a class="sourceLine" id="cb95-4" title="4">    <span class="st">&#39;perc.left =&#39;</span>,<span class="kw">mean</span>(nor.perc[,<span class="dv">1</span>]<span class="op">&gt;=</span>me))</a></code></pre></div>
<pre><code>## norm.left= 0.035 basic.left = 0.043 perc.left = 0.009</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1"><span class="co">#Calculate the right side probability of a normal distribution</span></a>
<a class="sourceLine" id="cb97-2" title="2"><span class="kw">cat</span>(<span class="st">&#39;norm.right=&#39;</span>,<span class="kw">mean</span>(nor.norm[,<span class="dv">2</span>]<span class="op">&lt;=</span>me ),</a>
<a class="sourceLine" id="cb97-3" title="3">    <span class="st">&#39;basic.right =&#39;</span>,<span class="kw">mean</span>(nor.basic[,<span class="dv">2</span>]<span class="op">&lt;=</span>me ),</a>
<a class="sourceLine" id="cb97-4" title="4">    <span class="st">&#39;perc.right =&#39;</span>,<span class="kw">mean</span>(nor.perc[,<span class="dv">2</span>]<span class="op">&lt;=</span>me))</a></code></pre></div>
<pre><code>## norm.right= 0.046 basic.right = 0.047 perc.right = 0.014</code></pre>
<p><span class="math inline">\(\text{Chi-square distribution}\)</span></p>
<p>Calculating true skewness using Monte Carlo method.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1">pian.real&lt;-<span class="kw">mean</span>(<span class="kw">replicate</span>(<span class="dv">1000</span>,<span class="dt">expr =</span> {</a>
<a class="sourceLine" id="cb99-2" title="2">  x0&lt;-<span class="kw">rchisq</span>(<span class="dv">1000</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb99-3" title="3">  <span class="kw">mean</span>((x0<span class="dv">-5</span>)<span class="op">^</span><span class="dv">3</span>)<span class="op">/</span><span class="dv">10</span><span class="op">^</span><span class="fl">1.5</span></a>
<a class="sourceLine" id="cb99-4" title="4">}))</a>
<a class="sourceLine" id="cb99-5" title="5"><span class="kw">print</span>(pian.real)</a></code></pre></div>
<pre><code>## [1] 1.248753</code></pre>
<p>We take a sample with a normal distribution of <span class="math inline">\(\chi^{2}(5)\)</span>, the sample size is 20, and each time we do bootstrap 1000 times, we cycle 1000 experiments. The coverage of the interval is calculated based on the experimental results.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1">me&lt;-pian.real</a>
<a class="sourceLine" id="cb101-2" title="2">n&lt;-<span class="dv">20</span></a>
<a class="sourceLine" id="cb101-3" title="3">m&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb101-4" title="4"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb101-5" title="5"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb101-6" title="6">chi.norm&lt;-chi.basic&lt;-chi.perc&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb101-7" title="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb101-8" title="8">  data.chisq&lt;-<span class="kw">rchisq</span>(n,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb101-9" title="9">  chisq.ske&lt;-<span class="kw">boot</span>(data.chisq,<span class="dt">statistic=</span>sk,<span class="dt">R=</span><span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb101-10" title="10">  chi&lt;-<span class="st"> </span><span class="kw">boot.ci</span>(chisq.ske,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb101-11" title="11">  chi.norm[i,]&lt;-chi<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>];</a>
<a class="sourceLine" id="cb101-12" title="12">  chi.basic[i,]&lt;-chi<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>];</a>
<a class="sourceLine" id="cb101-13" title="13">  chi.perc[i,]&lt;-chi<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>];</a>
<a class="sourceLine" id="cb101-14" title="14">}</a>
<a class="sourceLine" id="cb101-15" title="15"><span class="co">#Calculate the coverage probability of the chi-square distribution</span></a>
<a class="sourceLine" id="cb101-16" title="16"><span class="kw">cat</span>(<span class="st">&#39;norm =&#39;</span>,<span class="kw">mean</span>(chi.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span>me <span class="op">&amp;</span><span class="st"> </span>chi.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span>me),</a>
<a class="sourceLine" id="cb101-17" title="17">    <span class="st">&#39;basic =&#39;</span>,<span class="kw">mean</span>(chi.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span>me <span class="op">&amp;</span><span class="st"> </span>chi.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span>me),</a>
<a class="sourceLine" id="cb101-18" title="18">    <span class="st">&#39;perc =&#39;</span>,<span class="kw">mean</span>(chi.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span>me <span class="op">&amp;</span><span class="st"> </span>chi.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span>me))</a></code></pre></div>
<pre><code>## norm = 0.746 basic = 0.731 perc = 0.732</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1"><span class="co">#Calculate the probability of the left side of the chi-square distribution</span></a>
<a class="sourceLine" id="cb103-2" title="2"><span class="kw">cat</span>(<span class="st">&#39;norm.left=&#39;</span>,<span class="kw">mean</span>(chi.norm[,<span class="dv">1</span>]<span class="op">&gt;=</span>me ),</a>
<a class="sourceLine" id="cb103-3" title="3">    <span class="st">&#39;basic.left =&#39;</span>,<span class="kw">mean</span>(chi.basic[,<span class="dv">1</span>]<span class="op">&gt;=</span>me ),</a>
<a class="sourceLine" id="cb103-4" title="4">    <span class="st">&#39;perc.left =&#39;</span>,<span class="kw">mean</span>(chi.perc[,<span class="dv">1</span>]<span class="op">&gt;=</span>me))</a></code></pre></div>
<pre><code>## norm.left= 0.023 basic.left = 0.032 perc.left = 0</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1"><span class="co">#Calculate the right side probability of the chi-square distribution</span></a>
<a class="sourceLine" id="cb105-2" title="2"><span class="kw">cat</span>(<span class="st">&#39;norm.right=&#39;</span>,<span class="kw">mean</span>(chi.norm[,<span class="dv">2</span>]<span class="op">&lt;=</span>me ),</a>
<a class="sourceLine" id="cb105-3" title="3">    <span class="st">&#39;basic.right =&#39;</span>,<span class="kw">mean</span>(chi.basic[,<span class="dv">2</span>]<span class="op">&lt;=</span>me ),</a>
<a class="sourceLine" id="cb105-4" title="4">    <span class="st">&#39;perc.right =&#39;</span>,<span class="kw">mean</span>(chi.perc[,<span class="dv">2</span>]<span class="op">&lt;=</span>me))</a></code></pre></div>
<pre><code>## norm.right= 0.231 basic.right = 0.237 perc.right = 0.268</code></pre>
<p><span class="math inline">\(\textbf{Analysis}\)</span>:The coverage interval of the skewness of the normal distribution is much better than the chi-square distribution. The interval coverage probability of a normal distribution is greater than 0.9, and the chi-square distribution is approximately 0.7.</p>
</div>
</div>
<div id="the-homework-7" class="section level1">
<h1>The homework 7</h1>
<div id="questions-6" class="section level2">
<h2>Questions</h2>
<p><span class="math inline">\(\textbf{7.8}\)</span>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of $.</p>
<p><span class="math inline">\(\textbf{7.10}\)</span> In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Repeat the analysis replacing the Log-Log model with a cubic polynomial model. Which of the four models is selected by the cross validation procedure? Which model is selected according to maximum adjusted <span class="math inline">\(R^{2}\)</span> ?</p>
</div>
<div id="process" class="section level2">
<h2>Process</h2>
</div>
<div id="question-7.8" class="section level2">
<h2>Question 7.8</h2>
<p>Load the package and read in the data to calculate the data covariance matrix. Show the first five rows of data.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1"><span class="kw">library</span>(bootstrap) <span class="co">#for the score data</span></a>
<a class="sourceLine" id="cb107-2" title="2"><span class="kw">cov</span>(scor)</a></code></pre></div>
<pre><code>##          mec       vec       alg       ana       sta
## mec 305.7680 127.22257 101.57941 106.27273 117.40491
## vec 127.2226 172.84222  85.15726  94.67294  99.01202
## alg 101.5794  85.15726 112.88597 112.11338 121.87056
## ana 106.2727  94.67294 112.11338 220.38036 155.53553
## sta 117.4049  99.01202 121.87056 155.53553 297.75536</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1"><span class="co">#show a part of data</span></a>
<a class="sourceLine" id="cb109-2" title="2">scor[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,]</a></code></pre></div>
<pre><code>##   mec vec alg ana sta
## 1  77  82  67  67  81
## 2  63  78  80  70  81
## 3  75  73  71  66  81
## 4  55  72  63  70  68
## 5  63  63  65  70  63</code></pre>
<p>A function that defines a covariance matrix</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1">mcov &lt;-<span class="st"> </span><span class="cf">function</span>(x,j) <span class="kw">cov</span>(x[j,])</a></code></pre></div>
<p>We obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" title="1"><span class="co">#Computing data dimension</span></a>
<a class="sourceLine" id="cb112-2" title="2">n&lt;-<span class="kw">lengths</span>(scor)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb112-3" title="3"><span class="co">#Calculate the real covariance matrix</span></a>
<a class="sourceLine" id="cb112-4" title="4">real.cov &lt;-<span class="st"> </span><span class="kw">mcov</span>(scor,<span class="dv">1</span><span class="op">:</span>n)</a>
<a class="sourceLine" id="cb112-5" title="5"><span class="co">#Calculate the real theta value</span></a>
<a class="sourceLine" id="cb112-6" title="6">the.hat&lt;-<span class="kw">eigen</span>(real.cov)<span class="op">$</span>values[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(<span class="kw">eigen</span>(real.cov)<span class="op">$</span>values)</a>
<a class="sourceLine" id="cb112-7" title="7"><span class="co">#Define variables to store values</span></a>
<a class="sourceLine" id="cb112-8" title="8">the.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb112-9" title="9"><span class="co">#Loop n times</span></a>
<a class="sourceLine" id="cb112-10" title="10"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb112-11" title="11">the.cov &lt;-<span class="st"> </span><span class="kw">mcov</span>(scor,(<span class="dv">1</span><span class="op">:</span>n)[<span class="op">-</span>i])</a>
<a class="sourceLine" id="cb112-12" title="12"><span class="co">#Get matrix eigenvalues</span></a>
<a class="sourceLine" id="cb112-13" title="13">eig1&lt;-<span class="kw">eigen</span>(the.cov)<span class="op">$</span>values</a>
<a class="sourceLine" id="cb112-14" title="14"><span class="co">#Find the estimate of lambda</span></a>
<a class="sourceLine" id="cb112-15" title="15">the.jack[i]&lt;-eig1[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(eig1)</a>
<a class="sourceLine" id="cb112-16" title="16">}</a>
<a class="sourceLine" id="cb112-17" title="17"><span class="co">#Calculation bias</span></a>
<a class="sourceLine" id="cb112-18" title="18">bias1 &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(the.jack)<span class="op">-</span>the.hat)</a>
<a class="sourceLine" id="cb112-19" title="19"><span class="co">#Calculating  standard deviation</span></a>
<a class="sourceLine" id="cb112-20" title="20">se1 &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((the.jack<span class="op">-</span>the.hat)<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb112-21" title="21"><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">original=</span>the.hat,<span class="dt">estimate=</span><span class="kw">mean</span>(the.jack),<span class="dt">bias1=</span>bias1,</a>
<a class="sourceLine" id="cb112-22" title="22"><span class="dt">se1=</span>se1),<span class="dv">3</span>)</a></code></pre></div>
<pre><code>##  original  estimate bias1.mec   se1.mec 
##     0.619     0.619     0.001     0.050</code></pre>
<p><span class="math inline">\(\textbf{Analysis}\)</span>:The estimated value of lambda is 0.619.The deviation is only 0.001, it can be seen that the Jacknife method works better. The standard deviation value is 0.05</p>
</div>
<div id="question-7.10" class="section level2">
<h2>Question 7.10</h2>
<p>Define a function to calculate adjusted <span class="math inline">\(R^{2}\)</span></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1">r2&lt;-<span class="cf">function</span>(x,y,p){</a>
<a class="sourceLine" id="cb114-2" title="2">  a&lt;-(n<span class="dv">-2</span>)<span class="op">*</span>(<span class="kw">sum</span>((y<span class="op">-</span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sum</span>((x<span class="op">-</span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>(n<span class="dv">-2</span><span class="op">-</span>p)</a>
<a class="sourceLine" id="cb114-3" title="3">}</a></code></pre></div>
<p>Load package DAAG and get dataset.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1"><span class="kw">library</span>(DAAG);</a></code></pre></div>
<pre><code>## è½½å…¥éœ€è¦çš„ç¨‹è¾‘åŒ…ï¼šlattice</code></pre>
<pre><code>## 
## è½½å…¥ç¨‹è¾‘åŒ…ï¼š&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1"><span class="kw">attach</span>(ironslag);</a></code></pre></div>
<p>I repeat the analysis replacing the Log-Log model with a cubic polynomial model.And I calculate <span class="math inline">\(R^{2}\)</span> of every method.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1">n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></a>
<a class="sourceLine" id="cb120-2" title="2">e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb120-3" title="3"><span class="co"># for n-fold cross validation</span></a>
<a class="sourceLine" id="cb120-4" title="4"><span class="co"># fit models on leave-one-out samples</span></a>
<a class="sourceLine" id="cb120-5" title="5">yhat1&lt;-yhat2&lt;-yhat3&lt;-yhat4&lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb120-6" title="6"><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb120-7" title="7">y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb120-8" title="8">x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb120-9" title="9"><span class="co">#Linear model</span></a>
<a class="sourceLine" id="cb120-10" title="10">J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb120-11" title="11">yhat1[k] &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</a>
<a class="sourceLine" id="cb120-12" title="12">e1[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1[k]</a>
<a class="sourceLine" id="cb120-13" title="13"></a>
<a class="sourceLine" id="cb120-14" title="14"><span class="co">#Quadratic model</span></a>
<a class="sourceLine" id="cb120-15" title="15">J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb120-16" title="16">yhat2[k] &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span></a>
<a class="sourceLine" id="cb120-17" title="17">J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb120-18" title="18">e2[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2[k]</a>
<a class="sourceLine" id="cb120-19" title="19"></a>
<a class="sourceLine" id="cb120-20" title="20"><span class="co">#Exponential model</span></a>
<a class="sourceLine" id="cb120-21" title="21">J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb120-22" title="22">logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</a>
<a class="sourceLine" id="cb120-23" title="23">yhat3[k] &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</a>
<a class="sourceLine" id="cb120-24" title="24">e3[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3[k]</a>
<a class="sourceLine" id="cb120-25" title="25"></a>
<a class="sourceLine" id="cb120-26" title="26"><span class="co"># cubic polynomial model</span></a>
<a class="sourceLine" id="cb120-27" title="27">J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb120-28" title="28">yhat4[k]&lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span>J4<span class="op">$</span>coef[<span class="dv">3</span>]<span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span><span class="op">+</span>J4<span class="op">$</span>coef[<span class="dv">4</span>]<span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb120-29" title="29">e4[k]&lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4[k]</a>
<a class="sourceLine" id="cb120-30" title="30"></a>
<a class="sourceLine" id="cb120-31" title="31">}</a>
<a class="sourceLine" id="cb120-32" title="32"><span class="co">#calculate R^2 of four methods</span></a>
<a class="sourceLine" id="cb120-33" title="33">rsq1&lt;-<span class="kw">r2</span>( magnetic,yhat1,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb120-34" title="34">rsq2&lt;-<span class="kw">r2</span>( magnetic,yhat2,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb120-35" title="35">rsq3&lt;-<span class="kw">r2</span>( magnetic,yhat3,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb120-36" title="36">rsq4&lt;-<span class="kw">r2</span>( magnetic,yhat4,<span class="dv">3</span>)</a></code></pre></div>
<p>Output squared error and adjusted <span class="math inline">\(R^{2}\)</span> value of four methods.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" title="1"><span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>))</a></code></pre></div>
<pre><code>## [1] 19.55644 17.85248 18.44188 18.17756</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1"><span class="kw">c</span>(rsq1,rsq2,rsq3,rsq4)</a></code></pre></div>
<pre><code>## [1] 0.5450654 0.5944676 0.4676507 0.5818290</code></pre>
<p><span class="math inline">\(\textbf{Analysis}\)</span>:The quadratic model has the smallest sum of squared errors, and the adjusted <span class="math inline">\(R^{2}\)</span> is the largest, so the quadratic model is the best model.</p>
</div>
</div>
<div id="the-homework-8" class="section level1">
<h1>The homework 8</h1>
<div id="questions-7" class="section level2">
<h2>Questions</h2>
<p><span class="math inline">\(\textbf{Question1:}\)</span> 8.3 The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
<p><span class="math inline">\(\textbf{Question2:}\)</span> Power comparison (distance correlation test versus ball covariance test)</p>
<p>1.Model 1: Y = X/4 + e</p>
<p>2.Model 2: Y = X/4 * e</p>
<p>3.<span class="math inline">\(X â‰¥ N(0_{2},I_{2} )\)</span>, <span class="math inline">\(eâ‰¥ N(0_{2},I_{2})\)</span>, X and e are independent.</p>
</div>
<div id="question1" class="section level2">
<h2>Question1</h2>
<p><span class="math inline">\(\textbf{Thought:}\)</span>Use two methods and take different values of n to show the results.</p>
<p>Method 1: Use the number of extreme values as statistics and take 6 different values of n.Â Draw a conclusion by comparing with the size of the original statistic,and the table shows the results. Method 2: Use the results of extreme value tests as statistics, and take 6 different values of n.Â The conclusion is drawn by comparing with the size of the original statistic, and the results are plotted.</p>
<p><span class="math inline">\(\textbf{Method 1:}\)</span></p>
<p>Writing Statistics Functions</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" title="1"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb125-2" title="2">count5test &lt;-<span class="st"> </span><span class="cf">function</span>(z,ix,sizes) {</a>
<a class="sourceLine" id="cb125-3" title="3">n11&lt;-sizes[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb125-4" title="4">n22&lt;-sizes[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb125-5" title="5">n0&lt;-n11<span class="op">+</span>n22</a>
<a class="sourceLine" id="cb125-6" title="6">z&lt;-z[ix]</a>
<a class="sourceLine" id="cb125-7" title="7">x1&lt;-z[<span class="dv">1</span><span class="op">:</span>n11]</a>
<a class="sourceLine" id="cb125-8" title="8">y1&lt;-z[(n11<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n0]</a>
<a class="sourceLine" id="cb125-9" title="9">X &lt;-<span class="st"> </span>x1 <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x1)</a>
<a class="sourceLine" id="cb125-10" title="10">Y &lt;-<span class="st"> </span>y1<span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y1)</a>
<a class="sourceLine" id="cb125-11" title="11">outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</a>
<a class="sourceLine" id="cb125-12" title="12">outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</a>
<a class="sourceLine" id="cb125-13" title="13"><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></a>
<a class="sourceLine" id="cb125-14" title="14"><span class="kw">return</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)))</a>
<a class="sourceLine" id="cb125-15" title="15">}</a></code></pre></div>
<p>Write functions and display them in tables</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" title="1"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb126-2" title="2">n1&lt;-<span class="dv">30</span></a>
<a class="sourceLine" id="cb126-3" title="3">n2&lt;-<span class="kw">c</span>(<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>)</a>
<a class="sourceLine" id="cb126-4" title="4">u1&lt;-u2&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb126-5" title="5">sig1&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb126-6" title="6">sig2&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb126-7" title="7">p.value&lt;-<span class="kw">numeric</span>(<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb126-8" title="8">a=<span class="dv">1</span></a>
<a class="sourceLine" id="cb126-9" title="9"><span class="cf">for</span> (i <span class="cf">in</span> n2) {</a>
<a class="sourceLine" id="cb126-10" title="10">   n3&lt;-i</a>
<a class="sourceLine" id="cb126-11" title="11">   size1&lt;-<span class="kw">c</span>(n1,n3)</a>
<a class="sourceLine" id="cb126-12" title="12">   x&lt;-<span class="kw">rnorm</span>(n1,u1,sig1)</a>
<a class="sourceLine" id="cb126-13" title="13">   y&lt;-<span class="kw">rnorm</span>(n3,u2,sig2)</a>
<a class="sourceLine" id="cb126-14" title="14">   z&lt;-<span class="kw">c</span>(x,y)</a>
<a class="sourceLine" id="cb126-15" title="15">   <span class="kw">set.seed</span>(<span class="dv">4</span><span class="op">*</span>i);</a>
<a class="sourceLine" id="cb126-16" title="16">   boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> count5test, <span class="dt">R =</span> <span class="dv">999</span>, <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>,<span class="dt">sizes=</span>size1)</a>
<a class="sourceLine" id="cb126-17" title="17">   ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb126-18" title="18">   p.value[a]&lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb126-19" title="19">   a=a<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb126-20" title="20">}</a>
<a class="sourceLine" id="cb126-21" title="21"><span class="kw">data.frame</span>(n2,p.value)</a></code></pre></div>
<pre><code>##   n2 p.value
## 1 30   0.175
## 2 40   0.535
## 3 50   0.567
## 4 60   0.449
## 5 70   0.703
## 6 80   0.868</code></pre>
<p><span class="math inline">\(\textbf{Analysis:}\)</span>A value of p greater than 0.05 indicates that there is no sufficient reason to reject the null hypothesis and that their variances are the same.</p>
<p><span class="math inline">\(\textbf{Method 2:}\)</span></p>
<p>Writing Statistics Functions</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb128-2" title="2">count5test &lt;-<span class="st"> </span><span class="cf">function</span>(z,ix,sizes,kk) {</a>
<a class="sourceLine" id="cb128-3" title="3">n11&lt;-sizes[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb128-4" title="4">n22&lt;-sizes[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb128-5" title="5">n0&lt;-n11<span class="op">+</span>n22</a>
<a class="sourceLine" id="cb128-6" title="6">z&lt;-z[ix]</a>
<a class="sourceLine" id="cb128-7" title="7">x1&lt;-z[<span class="dv">1</span><span class="op">:</span>n11]</a>
<a class="sourceLine" id="cb128-8" title="8">y1&lt;-z[(n11<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n0]</a>
<a class="sourceLine" id="cb128-9" title="9">X &lt;-<span class="st"> </span>x1 <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x1)</a>
<a class="sourceLine" id="cb128-10" title="10">Y &lt;-<span class="st"> </span>y1<span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y1)</a>
<a class="sourceLine" id="cb128-11" title="11">outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</a>
<a class="sourceLine" id="cb128-12" title="12">outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</a>
<a class="sourceLine" id="cb128-13" title="13"><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></a>
<a class="sourceLine" id="cb128-14" title="14"><span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy))<span class="op">&gt;</span>kk))</a>
<a class="sourceLine" id="cb128-15" title="15">}</a></code></pre></div>
<p>Write functions and represent results with images</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb129-2" title="2">n1&lt;-<span class="dv">30</span></a>
<a class="sourceLine" id="cb129-3" title="3">n2&lt;-<span class="kw">c</span>(<span class="dv">35</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>)</a>
<a class="sourceLine" id="cb129-4" title="4">u1&lt;-u2&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb129-5" title="5">sig1&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb129-6" title="6">sig2&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb129-7" title="7">p.value2&lt;-<span class="kw">numeric</span>(<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb129-8" title="8">a=<span class="dv">1</span></a>
<a class="sourceLine" id="cb129-9" title="9"><span class="cf">for</span> (i <span class="cf">in</span> n2) {</a>
<a class="sourceLine" id="cb129-10" title="10">   n3&lt;-i</a>
<a class="sourceLine" id="cb129-11" title="11">   size1&lt;-<span class="kw">c</span>(n1,n3)</a>
<a class="sourceLine" id="cb129-12" title="12">   x&lt;-<span class="kw">rnorm</span>(n1,u1,sig1)</a>
<a class="sourceLine" id="cb129-13" title="13">   y&lt;-<span class="kw">rnorm</span>(n3,u2,sig2)</a>
<a class="sourceLine" id="cb129-14" title="14">   z&lt;-<span class="kw">c</span>(x,y)</a>
<a class="sourceLine" id="cb129-15" title="15">   <span class="kw">set.seed</span>(i);</a>
<a class="sourceLine" id="cb129-16" title="16">   boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> count5test, <span class="dt">R =</span> <span class="dv">999</span>, <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>,<span class="dt">sizes=</span>size1,<span class="dt">kk=</span>a<span class="op">+</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb129-17" title="17">   ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb129-18" title="18">   p.value2[a] &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">!=</span>ts[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb129-19" title="19">   a&lt;-a<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb129-20" title="20">}</a>
<a class="sourceLine" id="cb129-21" title="21"><span class="kw">data.frame</span>(n2,p.value2)</a></code></pre></div>
<pre><code>##   n2 p.value2
## 1 35    0.145
## 2 40    0.043
## 3 50    0.078
## 4 60    0.087
## 5 70    0.054
## 6 80    0.080</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1"><span class="kw">plot</span>(n2,p.value2,<span class="dt">type =</span> <span class="st">&#39;o&#39;</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(\textbf{Analysis:}\)</span>When n1 = n2, the p value of the statistic is small, but as the sample size increases, the p value gradually decreases, which is not as good as the first method.When n increases, we will increase the value of kk appropriately will have a good effect.</p>
</div>
<div id="question2-1" class="section level2">
<h2>Question2</h2>
<p><span class="math inline">\(\textbf{Thought:}\)</span>Compare the superiority of the two methods under different models. When the value of power is larger, the effect is better. Because the Ball method works well when the variance is large, the ball covariance test statistic is more dominant in the second model.</p>
<p>Writing the calling function</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" title="1">dCov &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb132-2" title="2">    x &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(x); y &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(y)</a>
<a class="sourceLine" id="cb132-3" title="3">    n &lt;-<span class="st"> </span><span class="kw">nrow</span>(x); m &lt;-<span class="st"> </span><span class="kw">nrow</span>(y)</a>
<a class="sourceLine" id="cb132-4" title="4">    <span class="cf">if</span> (n <span class="op">!=</span><span class="st"> </span>m <span class="op">||</span><span class="st"> </span>n <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>) <span class="kw">stop</span>(<span class="st">&quot;Sample sizes must agree&quot;</span>)</a>
<a class="sourceLine" id="cb132-5" title="5">    <span class="cf">if</span> (<span class="op">!</span><span class="st"> </span>(<span class="kw">all</span>(<span class="kw">is.finite</span>(<span class="kw">c</span>(x, y)))))</a>
<a class="sourceLine" id="cb132-6" title="6">    <span class="kw">stop</span>(<span class="st">&quot;Data contains missing or infinite values&quot;</span>)</a>
<a class="sourceLine" id="cb132-7" title="7">    Akl &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb132-8" title="8">        d &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">dist</span>(x))</a>
<a class="sourceLine" id="cb132-9" title="9">        m &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(d); M &lt;-<span class="st"> </span><span class="kw">mean</span>(d)</a>
<a class="sourceLine" id="cb132-10" title="10">        a &lt;-<span class="st"> </span><span class="kw">sweep</span>(d, <span class="dv">1</span>, m); b &lt;-<span class="st"> </span><span class="kw">sweep</span>(a, <span class="dv">2</span>, m)</a>
<a class="sourceLine" id="cb132-11" title="11">        b <span class="op">+</span><span class="st"> </span>M</a>
<a class="sourceLine" id="cb132-12" title="12">    }</a>
<a class="sourceLine" id="cb132-13" title="13">    A &lt;-<span class="st"> </span><span class="kw">Akl</span>(x); B &lt;-<span class="st"> </span><span class="kw">Akl</span>(y)</a>
<a class="sourceLine" id="cb132-14" title="14">    <span class="kw">sqrt</span>(<span class="kw">mean</span>(A <span class="op">*</span><span class="st"> </span>B))</a>
<a class="sourceLine" id="cb132-15" title="15">}</a></code></pre></div>
<p>Double loop, and get the power of the two models in two ways.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" title="1"><span class="kw">library</span>(MASS)</a></code></pre></div>
<pre><code>## 
## è½½å…¥ç¨‹è¾‘åŒ…ï¼š&#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:DAAG&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" title="1"><span class="kw">library</span>(Ball)</a>
<a class="sourceLine" id="cb136-2" title="2"><span class="co">#options(digits=3)</span></a>
<a class="sourceLine" id="cb136-3" title="3">alpha=<span class="fl">0.1</span></a>
<a class="sourceLine" id="cb136-4" title="4">mean &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb136-5" title="5">sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">ncol=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb136-6" title="6">cn&lt;-<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">80</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb136-7" title="7">p.value1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,<span class="dv">8</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb136-8" title="8">a=<span class="dv">1</span></a>
<a class="sourceLine" id="cb136-9" title="9"></a>
<a class="sourceLine" id="cb136-10" title="10">ndCov2 &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, dims) {</a>
<a class="sourceLine" id="cb136-11" title="11">    <span class="co">#dims contains dimensions of x and y</span></a>
<a class="sourceLine" id="cb136-12" title="12">    p &lt;-<span class="st"> </span>dims[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb136-13" title="13">    q &lt;-<span class="st"> </span>dims[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb136-14" title="14">    d &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span>q</a>
<a class="sourceLine" id="cb136-15" title="15">    x0 &lt;-<span class="st"> </span>z[, <span class="dv">1</span><span class="op">:</span>p] <span class="co">#leave x as is</span></a>
<a class="sourceLine" id="cb136-16" title="16">    y0 &lt;-<span class="st"> </span>z[ix, <span class="op">-</span>(<span class="dv">1</span><span class="op">:</span>p)] <span class="co">#permute rows of y</span></a>
<a class="sourceLine" id="cb136-17" title="17">    <span class="kw">return</span>(<span class="kw">nrow</span>(z) <span class="op">*</span><span class="st"> </span><span class="kw">dCov</span>(x0, y0)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb136-18" title="18">}</a>
<a class="sourceLine" id="cb136-19" title="19"></a>
<a class="sourceLine" id="cb136-20" title="20"><span class="cf">for</span> (i <span class="cf">in</span> cn) { </a>
<a class="sourceLine" id="cb136-21" title="21">    p.cor1&lt;-<span class="kw">numeric</span>(<span class="dv">50</span>)</a>
<a class="sourceLine" id="cb136-22" title="22">    p.cor2&lt;-<span class="kw">numeric</span>(<span class="dv">50</span>)</a>
<a class="sourceLine" id="cb136-23" title="23">    p.cor3&lt;-<span class="kw">numeric</span>(<span class="dv">50</span>)</a>
<a class="sourceLine" id="cb136-24" title="24">    p.cor4&lt;-<span class="kw">numeric</span>(<span class="dv">50</span>)</a>
<a class="sourceLine" id="cb136-25" title="25">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">50</span>) {</a>
<a class="sourceLine" id="cb136-26" title="26">      </a>
<a class="sourceLine" id="cb136-27" title="27">    xn&lt;-<span class="kw">mvrnorm</span>(<span class="dt">n=</span>i,mean,sigma)</a>
<a class="sourceLine" id="cb136-28" title="28">    en&lt;-<span class="kw">mvrnorm</span>(<span class="dt">n=</span>i,mean,sigma)</a>
<a class="sourceLine" id="cb136-29" title="29">    yn1&lt;-xn<span class="op">/</span><span class="dv">4</span><span class="op">+</span>en</a>
<a class="sourceLine" id="cb136-30" title="30">    yn2&lt;-xn<span class="op">/</span><span class="dv">4</span><span class="op">*</span>en</a>
<a class="sourceLine" id="cb136-31" title="31">    <span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb136-32" title="32">    </a>
<a class="sourceLine" id="cb136-33" title="33">    z1 &lt;-<span class="st"> </span><span class="kw">cbind</span>(xn,yn1)</a>
<a class="sourceLine" id="cb136-34" title="34">    boot.obj1 &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z1, <span class="dt">statistic =</span> ndCov2, <span class="dt">R =</span> <span class="dv">199</span>,<span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">dims =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb136-35" title="35">    tb1 &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj1<span class="op">$</span>t0, boot.obj1<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb136-36" title="36">    p.cor1[j]&lt;-<span class="st"> </span><span class="kw">mean</span>(tb1<span class="op">&gt;=</span>tb1[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb136-37" title="37">    p.cor3[j]&lt;-<span class="kw">bcov.test</span>(<span class="dt">x =</span> xn, <span class="dt">y =</span> yn1, <span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed =</span>i<span class="op">*</span><span class="dv">1234</span><span class="op">*</span>j)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb136-38" title="38">    z2 &lt;-<span class="st"> </span><span class="kw">cbind</span>(xn,yn2)</a>
<a class="sourceLine" id="cb136-39" title="39">    boot.obj2&lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z2, <span class="dt">statistic =</span> ndCov2, <span class="dt">R =</span> <span class="dv">199</span>,<span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">dims =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb136-40" title="40">    tb2 &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj2<span class="op">$</span>t0, boot.obj2<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb136-41" title="41">    p.cor2[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(tb2<span class="op">&gt;=</span>tb2[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb136-42" title="42">    p.cor4[j] &lt;-<span class="kw">bcov.test</span>(<span class="dt">x =</span> xn,<span class="dt">y =</span>yn2,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed =</span> i<span class="op">*</span><span class="dv">1233</span><span class="op">*</span>j)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb136-43" title="43">  }</a>
<a class="sourceLine" id="cb136-44" title="44">  p.value1[a,<span class="dv">1</span>]&lt;-<span class="kw">mean</span>(p.cor1<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb136-45" title="45">  p.value1[a,<span class="dv">2</span>]&lt;-<span class="kw">mean</span>(p.cor3<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb136-46" title="46">  p.value1[a,<span class="dv">3</span>]&lt;-<span class="kw">mean</span>(p.cor2<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb136-47" title="47">  p.value1[a,<span class="dv">4</span>]&lt;-<span class="kw">mean</span>(p.cor4<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb136-48" title="48">  a=a<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb136-49" title="49">  <span class="kw">print</span>(a)</a>
<a class="sourceLine" id="cb136-50" title="50">}</a></code></pre></div>
<pre><code>## [1] 2
## [1] 3
## [1] 4
## [1] 5
## [1] 6
## [1] 7
## [1] 8
## [1] 9</code></pre>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" title="1"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb138-2" title="2"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb138-3" title="3">    <span class="kw">plot</span>(cn,p.value1[,<span class="dv">1</span>],<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb138-4" title="4">    <span class="kw">lines</span>(cn,p.value1[,<span class="dv">2</span>],<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">col=</span><span class="st">&#39;yellow&#39;</span>)</a>
<a class="sourceLine" id="cb138-5" title="5">    <span class="kw">plot</span>(cn,p.value1[,<span class="dv">3</span>],<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb138-6" title="6">    <span class="kw">lines</span>(cn,p.value1[,<span class="dv">4</span>],<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">col=</span><span class="st">&#39;yellow&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(\textbf{Analysis:}\)</span>In the first model, the variance is not large, so the first method distance correlation test is better and more reliable. But in the second model, the variance is large, so the ball covariance test is better. When the sample size increases, the value of power both increases.</p>
</div>
</div>
<div id="the-homework-9" class="section level1">
<h1>The homework 9</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</div>
<div id="program-1" class="section level2">
<h2>Program</h2>
<p>The following function uses the Metropolis sampler method to calculate a Markov sequence.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" title="1">rp.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</a>
<a class="sourceLine" id="cb139-2" title="2">x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb139-3" title="3">x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb139-4" title="4">u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb139-5" title="5">k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb139-6" title="6"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb139-7" title="7">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb139-8" title="8"><span class="co">#Replace probability density function with Laplace distribution</span></a>
<a class="sourceLine" id="cb139-9" title="9"><span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(y))) <span class="op">/</span><span class="st"> </span>(<span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x[i<span class="dv">-1</span>]))))</a>
<a class="sourceLine" id="cb139-10" title="10">    x[i] &lt;-<span class="st"> </span>y </a>
<a class="sourceLine" id="cb139-11" title="11"><span class="cf">else</span> {</a>
<a class="sourceLine" id="cb139-12" title="12">    x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb139-13" title="13">    k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb139-14" title="14">}</a>
<a class="sourceLine" id="cb139-15" title="15">}</a>
<a class="sourceLine" id="cb139-16" title="16"><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb139-17" title="17">}</a></code></pre></div>
<p>Take different variances and observe when it is stable and the acceptance probability under different variances.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" title="1">N &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb140-2" title="2">sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">2</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb140-3" title="3">x0 &lt;-<span class="st"> </span><span class="dv">25</span></a>
<a class="sourceLine" id="cb140-4" title="4"><span class="co">#Get the return value of different variances</span></a>
<a class="sourceLine" id="cb140-5" title="5">rp1 &lt;-<span class="st"> </span><span class="kw">rp.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</a>
<a class="sourceLine" id="cb140-6" title="6">rp2 &lt;-<span class="st"> </span><span class="kw">rp.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</a>
<a class="sourceLine" id="cb140-7" title="7">rp3 &lt;-<span class="st"> </span><span class="kw">rp.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb140-8" title="8">rp4 &lt;-<span class="st"> </span><span class="kw">rp.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</a>
<a class="sourceLine" id="cb140-9" title="9"><span class="co">#Calculate acceptance probability</span></a>
<a class="sourceLine" id="cb140-10" title="10">p1&lt;-<span class="dv">1</span><span class="op">-</span>rp1<span class="op">$</span>k<span class="op">/</span>N</a>
<a class="sourceLine" id="cb140-11" title="11">p2&lt;-<span class="dv">1</span><span class="op">-</span>rp2<span class="op">$</span>k<span class="op">/</span>N</a>
<a class="sourceLine" id="cb140-12" title="12">p3&lt;-<span class="dv">1</span><span class="op">-</span>rp3<span class="op">$</span>k<span class="op">/</span>N</a>
<a class="sourceLine" id="cb140-13" title="13">p4&lt;-<span class="dv">1</span><span class="op">-</span>rp4<span class="op">$</span>k<span class="op">/</span>N</a>
<a class="sourceLine" id="cb140-14" title="14"><span class="kw">data.frame</span>(p1,p2,p3,p4)</a></code></pre></div>
<pre><code>##       p1    p2     p3     p4
## 1 0.9165 0.836 0.5125 0.1075</code></pre>
<p>A bigger problem is calculating the 0.025 and 0.975 quantiles. We need to solve the values of the independent variables when the distribution function is equal to 0.025 and 0.975. <span class="math display">\[0.025=\int_{-\infty}^{x_{1}} \frac{1}{2} e^{-| t |} d t\]</span> <span class="math display">\[0.975=\int_{0}^{x_{2}} \frac{1}{2} e^{-| t |} d t+0.5\]</span> And we get <span class="math inline">\(x_{1}=log(0.05)\)</span> ,<span class="math inline">\(x_{2}=-log(0.05)\)</span>.</p>
<p>Then we draw a Markov sequence diagram and mark 0.025 and 0.975 quantiles with horizontal lines</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" title="1">    <span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb142-2" title="2">    <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))  <span class="co">#display 4 graphs together</span></a>
<a class="sourceLine" id="cb142-3" title="3">    refline &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">log</span>(<span class="fl">0.05</span>),<span class="op">-</span><span class="kw">log</span>(<span class="fl">0.05</span>))</a>
<a class="sourceLine" id="cb142-4" title="4">    rp &lt;-<span class="st"> </span><span class="kw">cbind</span>(rp1<span class="op">$</span>x, rp2<span class="op">$</span>x, rp3<span class="op">$</span>x,  rp4<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb142-5" title="5">    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb142-6" title="6">        <span class="kw">plot</span>(rp[,j], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb142-7" title="7">             <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),</a>
<a class="sourceLine" id="cb142-8" title="8">             <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">30</span>),<span class="dt">col=</span><span class="st">&#39;blue&#39;</span>)</a>
<a class="sourceLine" id="cb142-9" title="9">        <span class="kw">abline</span>(<span class="dt">h=</span>refline,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</a>
<a class="sourceLine" id="cb142-10" title="10">    }</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(\textbf{Analysis:}\)</span></p>
<p>1.When different variances are used for the proposal distribution,They have different descent rates.The larger the variance, the faster the convergence. When the variance is small, it takes a long time to converge. When the variance is too large, the time in the same state is too long, and the efficiency is low.</p>
<p>2.The smaller the variance, the easier it is to reject the expected probability; the smaller the variance, the easier it is to accept the probability of acceptance.</p>
</div>
</div>
<div id="the-homework-10" class="section level1">
<h1>The homework 10</h1>
<div id="questions-8" class="section level2">
<h2>Questions</h2>
<p><span class="math inline">\(\textbf{11.1}\)</span>.The natural logarithm and exponential functions are inverses of each other, so that mathematically log(expx) = exp(logx) = x. Show by example that this property does not hold exactly in computer arithmetic. Does the identity hold with near equality? (See all.equal.)</p>
<p><span class="math inline">\(\textbf{11.5}\)</span>.Write a function to solve the equation <span class="math display">\[
\begin{aligned} \frac{2 \Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1)} \Gamma\left(\frac{k-1}{2}\right)} \int_{0}^{c_{k-1}}\left(1+\frac{u^{2}}{k-1}\right)^{-k / 2} d u \\=&amp; \frac{2 \Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k} \Gamma\left(\frac{k}{2}\right)} \int_{0}^{c_{k}}\left(1+\frac{u^{2}}{k}\right)^{-(k+1) / 2} d u \end{aligned}
\]</span></p>
<p>for a,where <span class="math display">\[c_{k}=\sqrt{\frac{a^{2}k}{k+1-a^{2}}}\]</span> Compare the solutions with the points A(k) in Exercise 11.4.</p>
<p><span class="math inline">\(\textbf{Question3:}\)</span></p>
<div class="figure">
<img src="data:image/png;base64,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" alt="Question3" />
<p class="caption">Question3</p>
</div>
</div>
<div id="question-1-3" class="section level2">
<h2>Question 1</h2>
<p>Randomly take numbers from 0 to 1000 to get equal probability.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" title="1">seq1&lt;-<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb143-2" title="2">tr1&lt;-tr2&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(seq1))</a>
<a class="sourceLine" id="cb143-3" title="3">wf&lt;-<span class="cf">function</span>(i){</a>
<a class="sourceLine" id="cb143-4" title="4"><span class="kw">return</span>(<span class="kw">exp</span>(<span class="kw">log</span>(i))<span class="op">==</span><span class="kw">log</span>(<span class="kw">exp</span>(i)))}</a>
<a class="sourceLine" id="cb143-5" title="5">dx&lt;-<span class="cf">function</span>(i){</a>
<a class="sourceLine" id="cb143-6" title="6">  <span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(<span class="kw">exp</span>(<span class="kw">log</span>(i)),<span class="kw">log</span>(<span class="kw">exp</span>(i))))</a>
<a class="sourceLine" id="cb143-7" title="7">}</a>
<a class="sourceLine" id="cb143-8" title="8"><span class="cf">for</span> (i <span class="cf">in</span> seq1){</a>
<a class="sourceLine" id="cb143-9" title="9">  tr1[i]&lt;-<span class="kw">wf</span>(i)</a>
<a class="sourceLine" id="cb143-10" title="10">  tr2[i]&lt;-<span class="kw">dx</span>(i)</a>
<a class="sourceLine" id="cb143-11" title="11">}</a>
<a class="sourceLine" id="cb143-12" title="12"><span class="kw">mean</span>(tr1)</a></code></pre></div>
<pre><code>## [1] 0.29</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb145-1" title="1"><span class="kw">mean</span>(tr2)</a></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>29% of the values show that the results are not equal.Different value ranges will have different equal probabilities.But using the function all.equal gives the result of equal probability 1.</p>
</div>
<div id="question-2-2" class="section level2">
<h2>Question 2</h2>
<p>First define the function to be called.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" title="1"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb147-2" title="2">k=<span class="dv">4</span></a>
<a class="sourceLine" id="cb147-3" title="3">ck&lt;-<span class="cf">function</span>(k,a){</a>
<a class="sourceLine" id="cb147-4" title="4">  <span class="kw">return</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb147-5" title="5">  }</a>
<a class="sourceLine" id="cb147-6" title="6">wf1 &lt;-<span class="st"> </span><span class="cf">function</span>(u) {</a>
<a class="sourceLine" id="cb147-7" title="7">(<span class="dv">1</span><span class="op">+</span>u<span class="op">*</span>u<span class="op">/</span>(k<span class="dv">-1</span>))<span class="op">^</span>(<span class="op">-</span>k<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb147-8" title="8">}</a>
<a class="sourceLine" id="cb147-9" title="9">wf2&lt;-<span class="st"> </span><span class="cf">function</span>(u) {</a>
<a class="sourceLine" id="cb147-10" title="10">(<span class="dv">1</span><span class="op">+</span>u<span class="op">*</span>u<span class="op">/</span>k)<span class="op">^</span>(<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb147-11" title="11">}</a>
<a class="sourceLine" id="cb147-12" title="12">wf3&lt;-<span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb147-13" title="13">  <span class="dv">2</span><span class="op">*</span><span class="kw">gamma</span>(k<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">sqrt</span>(pi<span class="op">*</span>(k<span class="dv">-1</span>))<span class="op">*</span><span class="kw">gamma</span>((k<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>))<span class="op">*</span><span class="kw">integrate</span>(wf1,<span class="dv">0</span>,<span class="kw">ck</span>(k<span class="dv">-1</span>,a))<span class="op">$</span>value<span class="dv">-2</span><span class="op">*</span><span class="kw">gamma</span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">sqrt</span>(pi<span class="op">*</span>k)<span class="op">*</span><span class="kw">gamma</span>(k<span class="op">/</span><span class="dv">2</span>))<span class="op">*</span><span class="kw">integrate</span>(wf2,<span class="dv">0</span>,<span class="kw">ck</span>(k,a))<span class="op">$</span>value</a>
<a class="sourceLine" id="cb147-14" title="14">}</a></code></pre></div>
<p>Calculate 11.5, the root value of a under different values of k.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" title="1">kt&lt;-<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">4</span>,<span class="dv">25</span>,<span class="dv">1</span>),<span class="dv">100</span>,<span class="dv">200</span>)</a>
<a class="sourceLine" id="cb148-2" title="2">solution11<span class="fl">.5</span>&lt;-solution11<span class="fl">.4</span>&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(kt))</a>
<a class="sourceLine" id="cb148-3" title="3">js=<span class="dv">1</span></a>
<a class="sourceLine" id="cb148-4" title="4"><span class="cf">for</span> (i <span class="cf">in</span> kt) {</a>
<a class="sourceLine" id="cb148-5" title="5">  k&lt;-kt[js]</a>
<a class="sourceLine" id="cb148-6" title="6">  solution11<span class="fl">.5</span>[js]&lt;-<span class="kw">uniroot</span>(wf3,<span class="kw">c</span>(<span class="fl">0.001</span>,<span class="kw">sqrt</span>(k)<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>))<span class="op">$</span>root</a>
<a class="sourceLine" id="cb148-7" title="7">  js=js<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb148-8" title="8">}</a></code></pre></div>
<p>Calculate 11.4, the root value of a with different values of k</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" title="1">js=<span class="dv">1</span></a>
<a class="sourceLine" id="cb149-2" title="2">wf4&lt;-<span class="cf">function</span>(a){<span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>)<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k<span class="dv">-1</span>)<span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k)}</a>
<a class="sourceLine" id="cb149-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> kt) {</a>
<a class="sourceLine" id="cb149-4" title="4">   k&lt;-kt[js]</a>
<a class="sourceLine" id="cb149-5" title="5">  solution11<span class="fl">.4</span>[js]&lt;-<span class="kw">uniroot</span>(wf4,<span class="kw">c</span>(<span class="fl">0.00001</span>,<span class="kw">sqrt</span>(k)<span class="op">-</span><span class="fl">0.0001</span>))<span class="op">$</span>root</a>
<a class="sourceLine" id="cb149-6" title="6">  js=js<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb149-7" title="7">}</a>
<a class="sourceLine" id="cb149-8" title="8"><span class="kw">data.frame</span>(kt,solution11<span class="fl">.4</span>,solution11<span class="fl">.5</span>)</a></code></pre></div>
<pre><code>##     kt solution11.4 solution11.5
## 1    4     1.492103     1.492103
## 2    5     1.533548     1.533567
## 3    6     1.562768     1.562719
## 4    7     1.584421     1.584429
## 5    8     1.601182     1.601183
## 6    9     1.614523     1.614522
## 7   10     1.625387     1.625383
## 8   11     1.634409     1.634409
## 9   12     1.642025     1.642019
## 10  13     1.648540     1.648540
## 11  14     1.654177     1.654194
## 12  15     1.659098     1.659120
## 13  16     1.663451     1.663408
## 14  17     1.667288     1.667273
## 15  18     1.670736     1.670724
## 16  19     1.673841     1.673817
## 17  20     1.676588     1.676607
## 18  21     1.679139     1.679154
## 19  22     1.681461     1.681479
## 20  23     4.795732     1.683578
## 21  24     4.898879     1.685521
## 22  25     4.999900     1.687347
## 23 100     9.999900     1.720600
## 24 200    14.142036     1.726318</code></pre>
<p>Analysis:These two questions almost give the same results using both methods.</p>
</div>
<div id="question-3-1" class="section level2">
<h2>Question 3</h2>
<p>Iterative formula for calculating p and qï¼š Let x and t be equal to:</p>
<p><span class="math display">\[x=\frac{\frac{n_{B}q_{i}}{2-q_{i}-2p_{i}}+n_{B}+n_{AB}}{\frac{n_{A}p_{i}}{2-p_{i}-2q_{i}}+n_{A}+n_{AB}}\]</span> <span class="math display">\[t=\frac{(1-\frac{p_{i}}{2-p_{i}-2q_{i}})n_{A}+(1-\frac{q_{i}}{2-2p_{i}-q_{i}})n_{B}+2n_{oo}}{\frac{n_{B}q_{i}}{2-q_{i}-2p_{i}}+n_{B}+n_{AB}}\]</span></p>
</div>
</div>
<div id="the-homework-11" class="section level1">
<h1>The homework 11</h1>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p><span class="math inline">\(\textbf{Question1:}\)</span>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:</p>
<pre><code>formulas &lt;- list(
mpg ~ disp,
mpg ~ I(1 / disp),
mpg ~ disp + wt,
mpg ~ I(1 / disp) + wt
)</code></pre>
<p><span class="math inline">\(\textbf{Question2:}\)</span>Fit the model mpg ~ disp to each of the bootstrap replicates of mtcars in the list below by using a for loop and lapply() . Can you do it without an anonymous function?</p>
<pre><code>bootstraps &lt;- lapply(1:10, function(i) {
rows &lt;- sample(1:nrow(mtcars), rep = TRUE)
mtcars[rows, ]
})</code></pre>
<p><span class="math inline">\(\textbf{Question3:}\)</span> For each model in the previous two exercises, extract R 2 using the function below.</p>
<pre><code>rsq &lt;- function(mod) summary(mod)$r.squared</code></pre>
<p><span class="math inline">\(\textbf{Question4:}\)</span> The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial. trials &lt;- replicate( 100, t.test(rpois(10, 10), rpois(7, 10)), simplify = FALSE ) Extra challenge: get rid of the anonymous function by using [[ directly. <span class="math inline">\(\textbf{Question5:}\)</span>Implement mcsapply() , a multicore version of sapply() . Can you implement mcvapply() , a parallel version of vapply() ? Why or why not?</p>
</div>
<div id="program-2" class="section level2">
<h2>Program</h2>
</div>
<div id="question-1-4" class="section level2">
<h2>Question 1</h2>
<p>The first method, using a for loop and lapply respectively.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" title="1">formulas1&lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb154-2" title="2">mpg <span class="op">~</span><span class="st"> </span>disp,</a>
<a class="sourceLine" id="cb154-3" title="3">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</a>
<a class="sourceLine" id="cb154-4" title="4">mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</a>
<a class="sourceLine" id="cb154-5" title="5">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</a>
<a class="sourceLine" id="cb154-6" title="6">)</a>
<a class="sourceLine" id="cb154-7" title="7">j=<span class="dv">1</span><span class="op">:</span><span class="dv">4</span></a>
<a class="sourceLine" id="cb154-8" title="8">li=<span class="kw">list</span>()</a>
<a class="sourceLine" id="cb154-9" title="9"><span class="co">#Use lapply</span></a>
<a class="sourceLine" id="cb154-10" title="10">la&lt;-<span class="kw">lapply</span>(j,<span class="cf">function</span>(j)<span class="kw">lm</span>(formulas1[[j]],<span class="dt">data =</span> mtcars))</a>
<a class="sourceLine" id="cb154-11" title="11">la</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas1[[j]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas1[[j]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas1[[j]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas1[[j]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" title="1"><span class="co">#Or use a for loop</span></a>
<a class="sourceLine" id="cb156-2" title="2"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb156-3" title="3">  li[[j]]&lt;-<span class="kw">lm</span>(formulas1[[j]],<span class="dt">data =</span> mtcars)</a>
<a class="sourceLine" id="cb156-4" title="4">}</a>
<a class="sourceLine" id="cb156-5" title="5">li</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas1[[j]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas1[[j]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas1[[j]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas1[[j]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<p>The second method, using a for loop and lapply respectively</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" title="1"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb158-2" title="2">formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb158-3" title="3">l1&lt;-<span class="cf">function</span>(mtcars) <span class="kw">glm</span>(mtcars<span class="op">$</span>mpg <span class="op">~</span><span class="st"> </span>mtcars<span class="op">$</span>disp),l2&lt;-<span class="cf">function</span>(mtcars) <span class="kw">glm</span>(mtcars<span class="op">$</span>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>mtcars<span class="op">$</span>disp)),l3&lt;-<span class="cf">function</span>(mtcars) <span class="kw">glm</span>(mtcars<span class="op">$</span>mpg <span class="op">~</span><span class="st"> </span>mtcars<span class="op">$</span>disp <span class="op">+</span><span class="st"> </span>mtcars<span class="op">$</span>wt),l4&lt;-<span class="cf">function</span>(mtcars) <span class="kw">glm</span>(mtcars<span class="op">$</span>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>mtcars<span class="op">$</span>disp) <span class="op">+</span>mtcars<span class="op">$</span>wt)</a>
<a class="sourceLine" id="cb158-4" title="4">)</a>
<a class="sourceLine" id="cb158-5" title="5"><span class="co">#Use lapply</span></a>
<a class="sourceLine" id="cb158-6" title="6">la1&lt;-<span class="kw">lapply</span>(formulas, <span class="cf">function</span>(f) <span class="kw">f</span>(mtcars))</a>
<a class="sourceLine" id="cb158-7" title="7"></a>
<a class="sourceLine" id="cb158-8" title="8"><span class="co">#Or use a for loop</span></a>
<a class="sourceLine" id="cb158-9" title="9">li1=<span class="kw">list</span>()</a>
<a class="sourceLine" id="cb158-10" title="10"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</a>
<a class="sourceLine" id="cb158-11" title="11">  <span class="co">#li1&lt;-list(li1,formulas[[i]](mtcars))</span></a>
<a class="sourceLine" id="cb158-12" title="12">  li1[[i]]&lt;-formulas[[i]](mtcars)</a>
<a class="sourceLine" id="cb158-13" title="13">}</a></code></pre></div>
</div>
<div id="question-2-3" class="section level2">
<h2>Question 2</h2>
<p>The first method, using a for loop and lapply respectively.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb159-1" title="1">formulas1&lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb159-2" title="2">mpg <span class="op">~</span><span class="st"> </span>disp,</a>
<a class="sourceLine" id="cb159-3" title="3">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</a>
<a class="sourceLine" id="cb159-4" title="4">mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</a>
<a class="sourceLine" id="cb159-5" title="5">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</a>
<a class="sourceLine" id="cb159-6" title="6">)</a>
<a class="sourceLine" id="cb159-7" title="7">  bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb159-8" title="8">  rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb159-9" title="9">  mtcars[rows, ]</a>
<a class="sourceLine" id="cb159-10" title="10">  })</a>
<a class="sourceLine" id="cb159-11" title="11">li0=<span class="kw">list</span>()</a>
<a class="sourceLine" id="cb159-12" title="12"><span class="co">#Use lapply</span></a>
<a class="sourceLine" id="cb159-13" title="13">j=<span class="dv">1</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb159-14" title="14">la0&lt;-<span class="kw">lapply</span>(j,<span class="cf">function</span>(j)<span class="kw">lm</span>(formulas1[[<span class="dv">1</span>]],<span class="dt">data =</span> bootstraps[[j]]))</a>
<a class="sourceLine" id="cb159-15" title="15">la0</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas1[[1]], data = bootstraps[[j]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.33385     -0.03705  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas1[[1]], data = bootstraps[[j]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.11684     -0.04238  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas1[[1]], data = bootstraps[[j]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.52212     -0.03993  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas1[[1]], data = bootstraps[[j]])
## 
## Coefficients:
## (Intercept)         disp  
##     28.8625      -0.0391  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = formulas1[[1]], data = bootstraps[[j]])
## 
## Coefficients:
## (Intercept)         disp  
##     28.9193      -0.0376  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = formulas1[[1]], data = bootstraps[[j]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.66218     -0.04591  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = formulas1[[1]], data = bootstraps[[j]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.60024     -0.03494  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = formulas1[[1]], data = bootstraps[[j]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.15150     -0.04127  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = formulas1[[1]], data = bootstraps[[j]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.93390     -0.03834  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = formulas1[[1]], data = bootstraps[[j]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.54723     -0.04186</code></pre>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb161-1" title="1"><span class="co">#Or use a for loop</span></a>
<a class="sourceLine" id="cb161-2" title="2"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) {</a>
<a class="sourceLine" id="cb161-3" title="3">  li0[[j]]&lt;-<span class="kw">lm</span>(formulas1[[<span class="dv">1</span>]],<span class="dt">data =</span> bootstraps[[j]])</a>
<a class="sourceLine" id="cb161-4" title="4">}</a>
<a class="sourceLine" id="cb161-5" title="5">li0</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas1[[1]], data = bootstraps[[j]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.33385     -0.03705  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas1[[1]], data = bootstraps[[j]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.11684     -0.04238  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas1[[1]], data = bootstraps[[j]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.52212     -0.03993  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas1[[1]], data = bootstraps[[j]])
## 
## Coefficients:
## (Intercept)         disp  
##     28.8625      -0.0391  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = formulas1[[1]], data = bootstraps[[j]])
## 
## Coefficients:
## (Intercept)         disp  
##     28.9193      -0.0376  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = formulas1[[1]], data = bootstraps[[j]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.66218     -0.04591  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = formulas1[[1]], data = bootstraps[[j]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.60024     -0.03494  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = formulas1[[1]], data = bootstraps[[j]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.15150     -0.04127  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = formulas1[[1]], data = bootstraps[[j]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.93390     -0.03834  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = formulas1[[1]], data = bootstraps[[j]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.54723     -0.04186</code></pre>
<p>The second method, using a for loop and lapply respectively</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb163-1" title="1"><span class="co">#Use lapply</span></a>
<a class="sourceLine" id="cb163-2" title="2">la2&lt;-<span class="kw">lapply</span>(bootstraps,formulas[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb163-3" title="3">li2&lt;-<span class="kw">list</span>()</a>
<a class="sourceLine" id="cb163-4" title="4"><span class="co">#Or use a for loop</span></a>
<a class="sourceLine" id="cb163-5" title="5"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) {</a>
<a class="sourceLine" id="cb163-6" title="6">  li2[[i]]&lt;-formulas[[<span class="dv">1</span>]](bootstraps[[i]])</a>
<a class="sourceLine" id="cb163-7" title="7">}</a></code></pre></div>
</div>
<div id="question3" class="section level2">
<h2>Question3</h2>
</div>
<div id="for-the-first-model" class="section level2">
<h2>For the first model</h2>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb164-1" title="1">formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb164-2" title="2">mpg <span class="op">~</span><span class="st"> </span>disp,</a>
<a class="sourceLine" id="cb164-3" title="3">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</a>
<a class="sourceLine" id="cb164-4" title="4">mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</a>
<a class="sourceLine" id="cb164-5" title="5">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</a>
<a class="sourceLine" id="cb164-6" title="6">)</a>
<a class="sourceLine" id="cb164-7" title="7">wf &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb164-8" title="8">rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb164-9" title="9">j =<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span></a>
<a class="sourceLine" id="cb164-10" title="10">wf &lt;-<span class="st"> </span><span class="kw">lapply</span>(j,<span class="cf">function</span>(j) {<span class="kw">rsq</span>(<span class="kw">lm</span>(formulas[[j]], <span class="dt">data =</span> mtcars))})</a>
<a class="sourceLine" id="cb164-11" title="11">wf</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
</div>
<div id="for-the-second-model" class="section level2">
<h2>For the second model</h2>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb166-1" title="1">bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb166-2" title="2">  rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb166-3" title="3">  mtcars[rows, ]</a>
<a class="sourceLine" id="cb166-4" title="4">  })</a>
<a class="sourceLine" id="cb166-5" title="5">wf &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb166-6" title="6">rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb166-7" title="7">j =<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb166-8" title="8">wf &lt;-<span class="st"> </span><span class="kw">lapply</span>(j,<span class="cf">function</span>(j) {<span class="kw">rsq</span>(<span class="kw">lm</span>(formulas[[<span class="dv">1</span>]], <span class="dt">data =</span> bootstraps[[j]]))})</a>
<a class="sourceLine" id="cb166-9" title="9">wf</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.6467266
## 
## [[2]]
## [1] 0.7225089
## 
## [[3]]
## [1] 0.7811281
## 
## [[4]]
## [1] 0.8499377
## 
## [[5]]
## [1] 0.6976296
## 
## [[6]]
## [1] 0.7450766
## 
## [[7]]
## [1] 0.7614065
## 
## [[8]]
## [1] 0.6538061
## 
## [[9]]
## [1] 0.718893
## 
## [[10]]
## [1] 0.6915524</code></pre>
</div>
<div id="question-4-1" class="section level2">
<h2>Question 4</h2>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb168-1" title="1">trials2 &lt;-<span class="st"> </span><span class="kw">replicate</span>(</a>
<a class="sourceLine" id="cb168-2" title="2"><span class="dv">100</span>,</a>
<a class="sourceLine" id="cb168-3" title="3"><span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</a>
<a class="sourceLine" id="cb168-4" title="4"><span class="dt">simplify =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb168-5" title="5">)</a>
<a class="sourceLine" id="cb168-6" title="6">tq&lt;-<span class="cf">function</span>(a)a<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb168-7" title="7"><span class="kw">sapply</span>(trials2,tq)</a></code></pre></div>
<pre><code>##   [1] 0.38642564 0.66146329 0.80811020 0.01551111 0.84368645 0.56989971
##   [7] 0.32272971 0.26079831 0.82967668 0.75295695 0.70252911 0.38378208
##  [13] 0.29886608 0.32778980 0.79742958 0.02997722 0.28969630 0.34757917
##  [19] 0.91759221 0.41752880 0.51704368 0.54841283 0.18978319 0.12405423
##  [25] 0.46760061 0.39080020 0.76511335 0.45227450 0.24322390 0.85868752
##  [31] 0.70663147 0.80010651 0.44249842 0.25943416 0.41092524 0.88435411
##  [37] 0.24053689 0.11626033 0.06523241 0.07381871 0.87467530 0.86942572
##  [43] 0.26591782 0.75667920 0.72749603 0.84685815 0.96401700 0.52741477
##  [49] 0.72820797 0.60948178 0.34490597 0.29594205 0.99132829 0.19172497
##  [55] 0.98169533 0.76232784 0.74235394 0.17545881 0.59255544 0.22580194
##  [61] 0.18970406 0.52345947 0.78246461 0.77598419 0.73372355 0.61510290
##  [67] 0.28054446 0.92649582 0.13616657 0.37813962 0.55615151 0.14739032
##  [73] 0.44791463 0.51462702 0.49792922 0.54409922 0.06693359 0.02229158
##  [79] 0.01947945 0.20262728 0.76787877 0.77104759 0.31293449 0.64954838
##  [85] 0.38570328 0.11493325 0.52482982 0.91431602 0.85114437 0.59551110
##  [91] 0.82704873 0.54298950 0.55577447 0.23006089 1.00000000 0.22382115
##  [97] 0.66015222 0.82524440 0.29914396 0.18226897</code></pre>
</div>
<div id="extra-challenge" class="section level2">
<h2>Extra challenge:</h2>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb170-1" title="1"><span class="kw">sapply</span>(trials2,<span class="st">&quot;[[&quot;</span>,<span class="dv">3</span>)</a></code></pre></div>
<pre><code>##   [1] 0.38642564 0.66146329 0.80811020 0.01551111 0.84368645 0.56989971
##   [7] 0.32272971 0.26079831 0.82967668 0.75295695 0.70252911 0.38378208
##  [13] 0.29886608 0.32778980 0.79742958 0.02997722 0.28969630 0.34757917
##  [19] 0.91759221 0.41752880 0.51704368 0.54841283 0.18978319 0.12405423
##  [25] 0.46760061 0.39080020 0.76511335 0.45227450 0.24322390 0.85868752
##  [31] 0.70663147 0.80010651 0.44249842 0.25943416 0.41092524 0.88435411
##  [37] 0.24053689 0.11626033 0.06523241 0.07381871 0.87467530 0.86942572
##  [43] 0.26591782 0.75667920 0.72749603 0.84685815 0.96401700 0.52741477
##  [49] 0.72820797 0.60948178 0.34490597 0.29594205 0.99132829 0.19172497
##  [55] 0.98169533 0.76232784 0.74235394 0.17545881 0.59255544 0.22580194
##  [61] 0.18970406 0.52345947 0.78246461 0.77598419 0.73372355 0.61510290
##  [67] 0.28054446 0.92649582 0.13616657 0.37813962 0.55615151 0.14739032
##  [73] 0.44791463 0.51462702 0.49792922 0.54409922 0.06693359 0.02229158
##  [79] 0.01947945 0.20262728 0.76787877 0.77104759 0.31293449 0.64954838
##  [85] 0.38570328 0.11493325 0.52482982 0.91431602 0.85114437 0.59551110
##  [91] 0.82704873 0.54298950 0.55577447 0.23006089 1.00000000 0.22382115
##  [97] 0.66015222 0.82524440 0.29914396 0.18226897</code></pre>
</div>
<div id="question-5" class="section level2">
<h2>Question 5</h2>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb172-1" title="1"><span class="kw">library</span>(parallel)</a>
<a class="sourceLine" id="cb172-2" title="2">formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb172-3" title="3">l1&lt;-<span class="cf">function</span>(mtcars) <span class="kw">glm</span>(mtcars<span class="op">$</span>mpg <span class="op">~</span><span class="st"> </span>mtcars<span class="op">$</span>disp),l2&lt;-<span class="cf">function</span>(mtcars) <span class="kw">glm</span>(mtcars<span class="op">$</span>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>mtcars<span class="op">$</span>disp)),l3&lt;-<span class="cf">function</span>(mtcars) <span class="kw">glm</span>(mtcars<span class="op">$</span>mpg <span class="op">~</span><span class="st"> </span>mtcars<span class="op">$</span>disp <span class="op">+</span><span class="st"> </span>mtcars<span class="op">$</span>wt),l4&lt;-<span class="cf">function</span>(mtcars) <span class="kw">glm</span>(mtcars<span class="op">$</span>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>mtcars<span class="op">$</span>disp) <span class="op">+</span>mtcars<span class="op">$</span>wt)</a>
<a class="sourceLine" id="cb172-4" title="4">)</a>
<a class="sourceLine" id="cb172-5" title="5">cl&lt;-<span class="kw">makeCluster</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb172-6" title="6">bootstraps2 &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3000</span>, <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb172-7" title="7">  rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb172-8" title="8">  mtcars[rows, ]})</a>
<a class="sourceLine" id="cb172-9" title="9"><span class="kw">system.time</span>(<span class="kw">sapply</span>(bootstraps2,formulas[[<span class="dv">1</span>]]))</a></code></pre></div>
<pre><code>## ç”¨æˆ· ç³»ç»Ÿ æµé€ 
## 2.87 0.02 2.88</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb174-1" title="1"><span class="kw">system.time</span>(<span class="kw">parSapply</span>(cl,bootstraps2,formulas[[<span class="dv">1</span>]]))</a></code></pre></div>
<pre><code>## ç”¨æˆ· ç³»ç»Ÿ æµé€ 
## 0.63 1.90 8.24</code></pre>
<p><span class="math inline">\(\mathbf{Analysis:}\)</span>It can be seen from the results that multi-core is significantly faster than using the sapply function alone. I donâ€™t think you can use multi-core for vapply because it cannot be unlisted.</p>
</div>
</div>
<div id="the-homework-12" class="section level1">
<h1>The homework 12</h1>
<div id="question-6" class="section level2">
<h2>Question</h2>
<p>You have already written an R function for Exercise 9.4 (page 277, Statistical Computing with R). Rewrite an Rcpp function for the same task. Compare the generated random numbers by the two functions using qqplot. Campare the computation time of the two functions with microbenchmark. Comments your results.</p>
</div>
<div id="program-3" class="section level2">
<h2>Program</h2>
<p>This is the r language code for exercise 9.4</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb176-1" title="1">rp.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</a>
<a class="sourceLine" id="cb176-2" title="2">x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb176-3" title="3">x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb176-4" title="4">u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb176-5" title="5">k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb176-6" title="6"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb176-7" title="7">   y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb176-8" title="8">   <span class="co">#Replace probability density function with Laplace distribution</span></a>
<a class="sourceLine" id="cb176-9" title="9">   <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(y))) <span class="op">/</span><span class="st"> </span>(<span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x[i<span class="dv">-1</span>]))))</a>
<a class="sourceLine" id="cb176-10" title="10">       x[i] &lt;-<span class="st"> </span>y </a>
<a class="sourceLine" id="cb176-11" title="11">   <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb176-12" title="12">       x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb176-13" title="13">       k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb176-14" title="14">        }</a>
<a class="sourceLine" id="cb176-15" title="15">     }</a>
<a class="sourceLine" id="cb176-16" title="16"><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb176-17" title="17">}</a></code></pre></div>
<p>Write c language code with cppfunction function in r as follows.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb177-1" title="1"><span class="kw">library</span>(Rcpp)</a>
<a class="sourceLine" id="cb177-2" title="2"><span class="kw">cppFunction</span>(<span class="st">&#39;NumericVector rp(double sigma,double xx,int N){</span></a>
<a class="sourceLine" id="cb177-3" title="3"><span class="st">#include&lt;Rcpp.h&gt;</span></a>
<a class="sourceLine" id="cb177-4" title="4"><span class="st">NumericVector x(N+1);</span></a>
<a class="sourceLine" id="cb177-5" title="5"><span class="st">x[0]=xx;</span></a>
<a class="sourceLine" id="cb177-6" title="6"><span class="st">int k=0;</span></a>
<a class="sourceLine" id="cb177-7" title="7"><span class="st">for(int i=1;i&lt;N;++i){</span></a>
<a class="sourceLine" id="cb177-8" title="8"><span class="st">  srand(i);</span></a>
<a class="sourceLine" id="cb177-9" title="9"><span class="st">  double u=rand()/(RAND_MAX+1.0);</span></a>
<a class="sourceLine" id="cb177-10" title="10"><span class="st">  double y=as&lt;double&gt;(rnorm(1, x[i-1], sigma));</span></a>
<a class="sourceLine" id="cb177-11" title="11"><span class="st">    if(u&lt;=(0.5*exp(-abs(y)))/(0.5*exp(-abs(x[i-1]))))</span></a>
<a class="sourceLine" id="cb177-12" title="12"><span class="st">        {x[i]=y;}</span></a>
<a class="sourceLine" id="cb177-13" title="13"><span class="st">    else{</span></a>
<a class="sourceLine" id="cb177-14" title="14"><span class="st">        x[i]=x[i-1];</span></a>
<a class="sourceLine" id="cb177-15" title="15"><span class="st">            k=k+1;</span></a>
<a class="sourceLine" id="cb177-16" title="16"><span class="st">            }</span></a>
<a class="sourceLine" id="cb177-17" title="17"><span class="st">}</span></a>
<a class="sourceLine" id="cb177-18" title="18"><span class="st">x[N]=k;</span></a>
<a class="sourceLine" id="cb177-19" title="19"><span class="st">return x;</span></a>
<a class="sourceLine" id="cb177-20" title="20"><span class="st">}</span></a>
<a class="sourceLine" id="cb177-21" title="21"><span class="st">            &#39;</span>)</a></code></pre></div>
<p>Write function comparison of output efficiency and probability of rejection</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb178-1" title="1">N &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb178-2" title="2">sigma &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb178-3" title="3"><span class="kw">library</span>(car)</a></code></pre></div>
<pre><code>## è½½å…¥éœ€è¦çš„ç¨‹è¾‘åŒ…ï¼šcarData</code></pre>
<pre><code>## 
## è½½å…¥ç¨‹è¾‘åŒ…ï¼š&#39;car&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:DAAG&#39;:
## 
##     vif</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     logit</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb183-1" title="1">x0 &lt;-<span class="dv">5</span></a>
<a class="sourceLine" id="cb183-2" title="2"><span class="kw">library</span>(microbenchmark)</a>
<a class="sourceLine" id="cb183-3" title="3"></a>
<a class="sourceLine" id="cb183-4" title="4">pic&lt;-<span class="cf">function</span>(i){</a>
<a class="sourceLine" id="cb183-5" title="5">ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(rp1 &lt;-<span class="st"> </span><span class="kw">rp.Metropolis</span>(sigma[i], x0, N),rpp1 &lt;-<span class="st"> </span><span class="kw">rp</span>(sigma[i], x0, N))</a>
<a class="sourceLine" id="cb183-6" title="6">tsr&lt;-<span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</a>
<a class="sourceLine" id="cb183-7" title="7"><span class="co">#rpp1</span></a>
<a class="sourceLine" id="cb183-8" title="8"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb183-9" title="9"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb183-10" title="10"><span class="co">#qqnorm(rp1$x,col=&#39;green&#39;)</span></a>
<a class="sourceLine" id="cb183-11" title="11"><span class="co">#qqline(rp1$x,col=&#39;red&#39;)</span></a>
<a class="sourceLine" id="cb183-12" title="12"><span class="co">#qqnorm(rpp1[1:N],col=&#39;green&#39;)</span></a>
<a class="sourceLine" id="cb183-13" title="13"><span class="co">#qqline(rpp1[1:N],col=&#39;red&#39;)</span></a>
<a class="sourceLine" id="cb183-14" title="14"><span class="kw">qqplot</span>(rp1<span class="op">$</span>x,rpp1[<span class="dv">1</span><span class="op">:</span>N],<span class="dt">col=</span><span class="st">&#39;green&#39;</span>)</a>
<a class="sourceLine" id="cb183-15" title="15"><span class="kw">qqline</span>(rpp1[<span class="dv">1</span><span class="op">:</span>N],<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</a>
<a class="sourceLine" id="cb183-16" title="16"><span class="kw">return</span>(<span class="kw">list</span>(rpp1[N<span class="op">+</span><span class="dv">1</span>],tsr))</a>
<a class="sourceLine" id="cb183-17" title="17">}</a></code></pre></div>
<p>Draw qqplot plots with different variances</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb184-1" title="1"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb184-2" title="2"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb184-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb184-4" title="4">  res&lt;-<span class="kw">pic</span>(i)</a>
<a class="sourceLine" id="cb184-5" title="5">  <span class="kw">print</span>(<span class="st">&quot;Probability of rejection&quot;</span>)</a>
<a class="sourceLine" id="cb184-6" title="6">  <span class="kw">print</span>(res[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb184-7" title="7">  <span class="kw">print</span>(<span class="st">&quot;Comparison of the two methods&quot;</span>)</a>
<a class="sourceLine" id="cb184-8" title="8">  <span class="kw">print</span>(res[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb184-9" title="9">  </a>
<a class="sourceLine" id="cb184-10" title="10">}</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAVFBMVEUAAAAAADoAAGYAOpAAZrYA/wA6AAA6ADo6AGY6OgA6OpA6kNtmAABmADpmAGaQOgCQOjqQ2/+2ZgC2///bkDrb////AAD/tmb/25D//7b//9v///+ljzLhAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAFPUlEQVR4nO3di3KbRgBAUbUNfaep05bY0f//Zy0JZCEBd4FdtLD3jicTRmZYneElIazD0UY7PHsAuScQJBAkECQQJBAkECQQJBAkECQQJBAkECQQdA90WL2nPO3wHoCePYDceiJQVa28wFk9D6g6/wg0VNX8I9BALVC91gJn9uxNrHYN6u99D12d1x+Bemv20LX7oP6aHVC92gLntyLQ5bzn8t/TP3WdeIFRWg+o2aquE3XqBcapHV/ql0bVef25EWoP71sBGpqOVFWdhT6Arqc/Ap2qzkf1qsdHoHNV1Zz3NN2cPgt0bDawfh+BTo34CHSqC9R9eSrQsQtU3718F+jYAXp4d0Ogzj768d0fgW5XoJ53xwRqzxKP/e8eFg9UVdctrPfd1dKByKd0IPQRCHwEuvjcnx4mW2D0kgJd15+Ri18lA113QGMXBwsGCvIpGCjMp1ygkP1P1AUmKtlVjUCfzQANTc8t1KdUoGCfQoHa3XPAh3+KBAo6fMVcYMJSALU+Ff9qkUCTfAoEmuZTLFDwZzOLA5roUxzQtO0rwgJTFxlosk9hQNN9CgSqJ/mUBXRZfSb5FAXU+AjUXzXLpxygmT7FAM31KQVotk8hQPN9ygBa4LMZoCVXNZrTwzk82wEamg6oXX0E6m+Zz/6BFvrsHmipz86Blhy+Zi1w/RYBRfDZNVAMnz0DRfHZOVC92GfHQEsPX5MX+JyWAMXw2S9QJJ8dA9WVQCPF8tkrUDSfvQJdfAQaKp7PPoEaH4H6q1sfgXqrH/8WR8wB5NZkoMg+mwEKvaoR22czQEPTd50+eyjQcPF99gV0/uyqQIOl8NkT0OWzzwIN1N7aFNlnN0DtR+djr0B7AbrzEeiu660X0X32AZTQZxdA9z4CdUvqswOgtD7bB0rss3WgmzvfBeqZvr2zMo3PtoE6d56m8dk00I1Pu/oI9DFdPfq4Bt1Mv/tcNRL6bBbofGtl61E9/FH6dAPIrYGrGqf152OFab7TIIXPZoC60+ft6/arZpL5bBPofOtORySRTs8AcqsPqE64ReEAcqsHqG72ys8ZQG49AtXHVAesoAHk1gNQ3f2eq9UHkFv346uvX1/5pAHk1uMmJlCnnp20m9htfYf59fbQPQPIrfn3aiQaQG4JBD0Ard5TnnZ4weOjX1z6eK4JBAkECQQJBAkECQQJBG113KslECQQJBAkECQQJBAkECQQJBAUCvT68+Hw039Dj37/cvjxn9lzZ10o0LdPY49+/XT6mTt31oUCff1j5MG3zy/H119HVqHRufMuEOj73y8jj55wTkjz5s67QKC3z78dfhh8lgQ0PnfeBQK9/vJyfPtraCMioPG58y4A6N/D4byPHSYgoPG5827CedDwU8Sd9OjceRcI9O39NOf198EzGTjMw9xZF7oGvW9nI6eCb3+OnyiOz511vtSABIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIL+B6NMsKZSxy3KAAAAAElFTkSuQmCC" /><!-- --></p>
<pre><code>## [1] &quot;Probability of rejection&quot;
## [[1]]
## [1] 504
## 
## [1] &quot;Comparison of the two methods&quot;
## [[1]]
##                                    expr        lq   median        uq
## 1 rp1 &lt;- rp.Metropolis(sigma[i], x0, N) 4991.5505 5624.934 8877.9365
## 2           rpp1 &lt;- rp(sigma[i], x0, N)  434.0235  446.861  593.5495</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] &quot;Probability of rejection&quot;
## [[1]]
## [1] 937
## 
## [1] &quot;Comparison of the two methods&quot;
## [[1]]
##                                    expr       lq   median       uq
## 1 rp1 &lt;- rp.Metropolis(sigma[i], x0, N) 4930.383 4996.648 5197.329
## 2           rpp1 &lt;- rp(sigma[i], x0, N)  432.325  435.345  440.065</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAV1BMVEUAAAAAADoAAGYAOjoAOpAAZrYA/wA6AAA6ADo6AGY6kNtmAABmADpmOpBmtv+QOgCQOmaQ2/+2ZgC225C2///bkDrb////AAD/tmb/25D//7b//9v///9eMfqYAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAFoUlEQVR4nO3da3ubNgBAYe9S7dKtXbOlTlL//985Y+zENpcjQMICznn6oWlTUN4KYXBLdgfrbffoAZSeQJBAkECQQJBAkECQQJBAkECQQJBAkECQQNA90G7u9g/5suNrAM28/33pU/iBQCEcfYo/xh8HdOQJ+/IXwYcBheME2geBOjsdXwJ1FqrjK8y4w7E9DGi/rw4ygbqqeMKcOxzbg4D2B4H62p9eBLkGdXVafoJAXZ3mTzgs6xB7v3jMvsdw47MYoK6Pkxf2lUx9iM2yw4nNDRTq8/v5FDbDDqc2M1Dt8zF/BLqt6SPQTfXrw4/jK/sOpzcjULjMn3D9qwJdqi5PDw0fgepCeD99HQRqdvE52QjUqPY5X8Df+ghUdbU8361AAlW1n74y7jBlMwD1+gh0uF6fIwZQWtmBwGfzQO/HV+wASiszEPpsGyiwz6aBYny2DBTqd097eZYDlP6mff/Ln8YASi3TDAoh0mejQPE+2wQKUctzwh1mLAfQEJ8tAg3y2SDQMJ/tAb37jBxAaaUGGuqzNaCLz/gBlFZaoOE+2wIa4bMpoBDe/3Hv+AGUVkKgQHdXowZQWkmBRvhsB2jc/NkMUBjrsxGg8T7bAJrgsxmgsT5bAJoyf5YDNPqmfRh8edo+gFKbOoOm+qwdaLLPuoHCdJ9VA9U803xWDJRi+gza4WMaCXR+U3Dw3R8eQGmNAQohnc8agZL6rBDoxif9AEprGFB9QZHSZ11AZ5nLy8MsAyitIUDhulSP1lonUPV/BzMNoLQGAF3xpPNZEVAen/UBVT9N+Wi/1QBdTZ+kjz5cH1DiJ0OuBSiXz+qAkj9ZdClAdNM+l89igLo+Ppf45TPvsJgGAeV4cu+agLI82XgdQCkv36N2WE5RQAlv/+AASisGKKfP8oES3n6OGkBpEdD5DuLkt7+iB1BaAHSePvl8Fg5UP/Jw/D/+GTGA0iKg04PVs+m0DKC0GCivz/KBcp3euwZQWr1A2Y+vlgGUVg9Qvf7cP3Ms9wBKqxsonJ9sLFD7x6fb8znP7x0DKK0+oPOjIecdQGn1HGL1k/kz+ywY6PLk8JkHUFptQOGy/jxiAKXV8q5GOH9jmRmmz2E5QB8fX02fOYQWCXR5+SNQ6xpUf18rD7G6FqDz5amL9Kkm0Mzf13NxQHN/39OlAVU+8xxbHQMorbZFOv/1Rc8ASqv9ddCMQgINHEBpeYhBnRerjxpAaQ36zyxzDKC0BIIaQLP3kC87vt7xtf1m6x+Y9IllJxAkECQQJBAkECQQJBC0vBHPnECQQJBAkECQQJBAkECQQJBAUD/Q6x//8SZ+fN39fP9pr7/tdl9Gbq+s+oGeGl952yd9qn7c9Pb5y+Hlp2/jtldWvUAvv0T8jb/99a0xM15+/X6cWI0pFLW9wuoD+vHPvxFfUIVTId1XzaIx2yusPqDnP2PWjC6g5+MsGrO9wuoBevv7+wSg58ZyE7m9wuoAet7tPj19iTrrtAM9N5foyO0VVvcMevt8euOz5WR993kti3TL/IneXmEleB3Ucpp//b25JkVvr6wSAB2nxv18eeqYLKsDMoEogSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIGg/wEaSujSdeoHYgAAAABJRU5ErkJggg==" /><!-- --></p>
<pre><code>## [1] &quot;Probability of rejection&quot;
## [[1]]
## [1] 1377
## 
## [1] &quot;Comparison of the two methods&quot;
## [[1]]
##                                    expr       lq    median       uq
## 1 rp1 &lt;- rp.Metropolis(sigma[i], x0, N) 4952.660 5022.3230 5188.078
## 2           rpp1 &lt;- rp(sigma[i], x0, N)  431.947  434.9675  442.519</code></pre>
<pre><code>## [1] &quot;Probability of rejection&quot;
## [[1]]
## [1] 1537
## 
## [1] &quot;Comparison of the two methods&quot;
## [[1]]
##                                    expr       lq    median        uq
## 1 rp1 &lt;- rp.Metropolis(sigma[i], x0, N) 4941.711 5025.3440 5215.8305
## 2           rpp1 &lt;- rp(sigma[i], x0, N)  427.794  431.7585  438.7435</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(\textbf{Analysis:}\)</span>It can be seen from qqlot that the two methods are from the same distribution and are approximately straight lines. In addition, the use of C language will greatly speed up the operation.C language only takes one tenth of the time of r language</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
